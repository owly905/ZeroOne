if (!hasInterface) exitWith {}; private["_display","_curTarget","_houseCfg","_Btn1","_Btn2","_Btn3","_Btn4","_Btn5","_Btn6","_Btn7","_Btn8","_Btn9","_Btn10","_Btn11","_Btn12","_Btn13","_pos","_house","_gang","_gangHouseUpgrades"]; disableSerialization; _curTarget = param[0,objNull,[objNull]]; if(isNull _curTarget) exitWith {closeDialog 0;}; _houseCfg = [(typeOf _curTarget)] call zero_fnc_houseConfig; if(_houseCfg isEqualTo [] && {typeOf _curTarget != "Land_fs_feed_F"}) exitWith {closeDialog 0;}; if(!dialog) then { createDialog "zero_var_pInteraction_Menu"; }; _display = findDisplay 37400; _Btn1 = _display displayCtrl 37450; _Btn2 = _display displayCtrl 37451; _Btn3 = _display displayCtrl 37452; _Btn4 = _display displayCtrl 37453; _Btn5 = _display displayCtrl 37454; _Btn6 = _display displayCtrl 37455; _Btn7 = _display displayCtrl 37456; _Btn8 = _display displayCtrl 37457; _Btn9 = _display displayCtrl 37458; _Btn10 = _display displayCtrl 37459; _Btn11 = _display displayCtrl 37460; _Btn12 = _display displayCtrl 37461; _Btn13 = _display displayCtrl 37462; _Btn1 ctrlShow false; _Btn2 ctrlShow false; _Btn3 ctrlShow false; _Btn4 ctrlShow false; _Btn5 ctrlShow false; _Btn6 ctrlShow false; _Btn7 ctrlShow false; _Btn8 ctrlShow false; _Btn9 ctrlShow false; _Btn10 ctrlShow false; _Btn11 ctrlShow false; _Btn12 ctrlShow false; _Btn13 ctrlShow false; zero_var_pInact_curTarget = _curTarget; if(typeOf _curTarget == "Land_fs_feed_F") exitWith { _Btn1 ctrlSetText "Kanister auffüllen"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;closeDialog 0; [] call zero_fnc_refillCanister;"; _Btn1 ctrlShow true; }; if(_curTarget isKindOf "House_F" && playerSide isEqualTo west) exitWith { if((nearestObject [[20889,19224,0],"Land_Research_HQ_F"]) == _curTarget) then { _Btn1 ctrlSetText localize "STR_pInAct_Repair"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_repairDoor; closeDialog 0;"; _Btn1 ctrlShow true; _Btn2 ctrlSetText localize "STR_pInAct_CloseOpen"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_doorAnimate; closeDialog 0;"; _Btn2 ctrlShow true; } else { if(!isNil {_curTarget getVariable "zero_var_house_owner"}) then { _Btn1 ctrlSetText localize "STR_House_Raid_Owner"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_copHouseOwner;"; _Btn1 ctrlShow true; _Btn2 ctrlSetText localize "STR_pInAct_BreakDown"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_copBreakDoor; closeDialog 0;"; _Btn2 ctrlShow true; _Btn3 ctrlSetText localize "STR_pInAct_LockHouse"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_lockupHouse; closeDialog 0;"; _Btn3 ctrlShow true; if(zero_var_pInact_curTarget getVariable["zero_var_furniture_allocated",false]) then { _Btn8 ctrlSetText "Möbel entfernen [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_furniture_deallocate; closeDialog 0;"; } else { _Btn8 ctrlSetText "Möbel laden [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;['normal', zero_var_pInact_curTarget] spawn zero_fnc_furniture_allocate; closeDialog 0;"; }; _ } else { closeDialog 0; }; }; }; if(!(_curTarget in zero_var_vehicles)) then { _Btn1 ctrlSetText localize "STR_pInAct_BuyHouse"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_buyHouse;"; _Btn1 ctrlShow true; if(zero_var_pInact_curTarget getVariable["zero_var_furniture_allocated",false]) then { _Btn8 ctrlSetText "Möbel entfernen [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_furniture_deallocate; closeDialog 0;"; }else{ _Btn8 ctrlSetText "Möbel laden [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;['normal', zero_var_pInact_curTarget] spawn zero_fnc_furniture_allocate; closeDialog 0;"; }; if(!isNil {_curTarget getVariable "zero_var_house_owner"}) then { _Btn1 ctrlEnable false; }; } else { if((typeOf _curTarget) in ["Land_i_Garage_V1_F","Land_i_Garage_V2_F"]) then { _Btn1 ctrlSetText localize "STR_pInAct_SellGarage"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_sellHouse; closeDialog 0;"; _Btn1 ctrlShow true;
if(((_curTarget getVariable "zero_var_house_owner") select 0) != (getPlayerUID player)) then { _Btn1 ctrlEnable false; }; _Btn2 ctrlSetText localize "STR_pInAct_AccessGarage"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[[(zero_var_pInact_curTarget modelToWorld [-10,0,0]),(getDir zero_var_pInact_curTarget)-90], ""Car"", ""CustomGarage""] spawn zero_fnc_vehicleGarage; closeDialog 0;"; _Btn2 ctrlShow true; _Btn3 ctrlSetText localize "STR_pInAct_StoreVeh"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget,player] spawn zero_fnc_storeVehicle; closeDialog 0;"; _Btn3 ctrlShow true; } else { _Btn1 ctrlSetText localize "STR_pInAct_SellHouse"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_sellHouse; closeDialog 0;"; _Btn1 ctrlShow true; _Btn7 ctrlSetText "Haus einrichten [BETA]"; _Btn7 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;closeDialog 0; [zero_var_pInact_curTarget] spawn zero_fnc_furniture_openEditor;"; _Btn9 ctrlSetText "Möbel kaufen [BETA]"; _Btn9 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;closeDialog 0; [] call zero_fnc_openFurnitureShop;"; if(((_curTarget getVariable "zero_var_house_owner") select 0) != (getPlayerUID player)) then { _Btn1 ctrlEnable false; _Btn7 ctrlEnable false; _Btn9 ctrlEnable false; }; if(!isNil "zero_var_gangHouse") then { _pos = call compile format["%1",zero_var_gangHouse]; _house = nearestBuilding _pos; if(_house != _curTarget) exitWith {}; _gang = (group player) getVariable["zero_var_gang",[]]; if(_gang isEqualTo []) exitWith {}; private _gangHouse = _gang select 6; _gangHouseUpgrades = (_gangHouse select 1); if(_gangHouseUpgrades isEqualTo []) exitWith {}; _Btn11 ctrlSetText "Clanskin"; _Btn11 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;closeDialog 0; true call zero_fnc_initpaintshop"; _Btn11 ctrlShow true; if("ATM" in _gangHouseUpgrades) then { _Btn2 ctrlSetText "ATM"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;closeDialog 0; [] call zero_fnc_atmMenu"; _Btn2 ctrlShow true; }; if("Markt" in _gangHouseUpgrades) then { _Btn3 ctrlSetText "Markt"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[""gang""] call zero_fnc_virt_menu"; _Btn3 ctrlShow true; }; if("General Store" in _gangHouseUpgrades) then { _Btn4 ctrlSetText "General Store"; _Btn4 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[""civ"",[""i""],""Item Shop""] spawn zero_fnc_shopMenu"; _Btn4 ctrlShow true; }; if("Medic" in _gangHouseUpgrades) then { _Btn5 ctrlSetText "Medic"; _Btn5 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_healHospital"; _Btn5 ctrlShow true; }; if("Garage" in _gangHouseUpgrades && (count _gangHouse > 2)) then { zero_var_gangSpawnPoint = _gangHouse select 2; _Btn6 ctrlSetText localize "STR_pInAct_AccessGarage"; if("Garagen Upgrade (LKW)" in _gangHouseUpgrades && "Garagen Upgrade (Gepanzert)" in _gangHouseUpgrades) exitWith { _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_gangSpawnPoint,""Car"",""GanghausBoth""] spawn zero_fnc_vehicleGarage; closeDialog 0; zero_var_gangSpawnPoint = nil;"; _Btn6 ctrlShow true; }; if("Garagen Upgrade (LKW)" in _gangHouseUpgrades) exitWith { _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_gangSpawnPoint,""Car"",""GanghausLKW""] spawn zero_fnc_vehicleGarage; closeDialog 0; zero_var_gangSpawnPoint = nil;"; _Btn6 ctrlShow true; }; if("Garagen Upgrade (Gepanzert)" in _gangHouseUpgrades) exitWith { _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_gangSpawnPoint,""Car"",""GanghausArmored""] spawn zero_fnc_vehicleGarage; closeDialog 0; zero_var_gangSpawnPoint = nil;"; _Btn6 ctrlShow true; }; if("Garage" in _gangHouseUpgrades) exitWith{ _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_gangSpawnPoint,""Car"",""Ganghaus""] spawn zero_fnc_vehicleGarage; closeDialog 0; zero_var_gangSpawnPoint = nil;"; _Btn6 ctrlShow true; }; }; }; if(zero_var_pInact_curTarget getVariable["zero_var_furniture_allocated",false]) then { _Btn8 ctrlSetText "Möbel entfernen [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_furniture_deallocate; closeDialog 0;"; }else{ _Btn8 ctrlSetText "Möbel laden [BETA]"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;['normal', zero_var_pInact_curTarget] spawn zero_fnc_furniture_allocate; closeDialog 0;"; }; }; };
