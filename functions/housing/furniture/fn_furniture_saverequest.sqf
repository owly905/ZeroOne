if (!hasInterface) exitWith {}; params [["_close",false]]; private _house = (findDisplay 175462) getVariable ["zero_var_house",objNull]; private _limit = (findDisplay 175462) getVariable ["zero_var_limit",20]; private _objects = (findDisplay 175462) getVariable ["zero_var_editorObjects",[]]; (getPosASL _house) params ["_hx","_hy","_hz"]; if (zero_var_furniture_requestInProgress) exitWith { (localize "STR_House_furniture_systemBusy") call zero_fnc_msg; }; zero_var_furniture_requestInProgress = true; private _buffer = []; { _x enableCollisionWith player; _x enableSimulation false; (getPosASL _x) params ["_px","_py","_pz"]; _px = _px - _hx; _py = _py - _hy; _pz = _pz - _hz; _px = (call compile ((str (_px - (floor _px))) select [0,5])) + (floor _px); _py = (call compile ((str (_py - (floor _py))) select [0,5])) + (floor _py);
_pz = (call compile ((str (_pz - (floor _pz))) select [0,5])) + (floor _pz); private _dir = round (getDir _x); private _hash = getNumber (missionConfigFile >> "zero_Furniture" >> "furnitureItems" >> (format ["frn_%1",typeOf _x]) >> "hash"); _buffer pushBack [_hash,_px,_py,_pz,_dir]; } forEach _objects; private _index = zero_var_furniture_allocationBuffers find _house; { if !(_x in _objects) then {[_x] call zero_fnc_deleteVehicle}; } forEach (zero_var_furniture_allocationBuffers select (_index + 1)); zero_var_furniture_allocationBuffers set [_index + 1,_objects]; [[_house,_buffer,_limit,getPlayerUID player, name player, profileName],"zero_fnc_updateHouseFurniture",zero_var_HC1_owner,false] call zero_fnc_sendPacket; zero_var_furniture_requestInProgress = false; if (_close) then { (findDisplay 175462) closeDisplay 0; };
