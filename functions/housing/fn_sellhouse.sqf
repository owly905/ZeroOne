if (!hasInterface) exitWith {}; private["_house","_action","_houseCfg","_index","_pos","_gangHouse","_exit","_numOfDoors"]; _house = param[0,objNull,[objNull]]; if(isNull _house || !(_house isKindOf "House_F")) exitWith {}; if(!isNil {(_house getVariable "zero_var_house_sold")}) exitWith {(localize "STR_House_Sell_Process") call zero_fnc_msg;}; if(!isNil "zero_var_gangHouse") then { _pos = call compile format["%1",zero_var_gangHouse]; _gangHouse = nearestBuilding _pos; if(_house == _gangHouse) exitWith {_exit = true; "Du kannst das Ganghauptquartier nicht verkaufen!" call zero_fnc_msg;}; }; if(!isNil "_exit") exitWith {systemChat format ["ex %1", _exit]}; closeDialog 0; _houseCfg = [(typeOf _house)] call zero_fnc_houseConfig; if(_houseCfg isEqualTo []) exitWith {}; _action = [ format[localize "STR_House_SellHouseMSG", (round((_houseCfg select 0)/2)) call zero_fnc_numberText, (_houseCfg select 1)],localize "STR_pInAct_SellHouse",localize "STR_Global_Sell",localize "STR_Global_Cancel" ] call BIS_fnc_guiMessage; if(_action) then { if(!isNil "_exit") exitWith {"Du kannst das Ganghauptquartier nicht verkaufen!" call zero_fnc_msg;
}; _house setVariable["zero_var_house_sold",true,true]; [[_house],"zero_fnc_sellHouseDB",zero_var_HC1_owner,false] call zero_fnc_sendPacket; _house setVariable["zero_var_locked",false,true]; deleteMarkerLocal format["house_%1",_house getVariable "uid"]; _house setVariable["uid",nil,true]; [0, ([2, 0] call zero_fnc_Z0Check) + (round((_houseCfg select 0)/2))] call zero_fnc_Z0Check; [format ["HOUSE SELL: %1 (%2, %3) hat ein Haus fuer %4 verkauft. Position %5", player getVariable["zero_var_realname",name player], getPlayerUID player, playerSide, [(_houseCfg select 0)] call zero_fnc_numberText, getPosATL _house]] call zero_fnc_zoLog; _index = zero_var_vehicles find _house; if(_index != -1) then { zero_var_vehicles deleteAt _index; }; _index = [str(getPosATL _house),zero_var_houses] call zero_fnc_findIndex; if(_index != -1) then { zero_var_houses deleteAt _index; }; _numOfDoors = getNumber(configFile >> "CfgVehicles" >> (typeOf _house) >> "numberOfDoors"); for "_i" from 1 to _numOfDoors do { _house setVariable[format["bis_disabled_Door_%1",_i],0,true]; }; };
