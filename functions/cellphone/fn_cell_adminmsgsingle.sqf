if (!hasInterface) exitWith {}; private["_msg","_to","_pos","_time","_pid","_chrByte","_allowed","_exit"]; if((call zero_var_adminLevel) < 1) exitWith {(localize "STR_CELL_Not_Admin") call zero_fnc_msg;}; _msg = ctrlText 3003; _to = call compile format["%1",(lbData[3002,(lbCurSel 3002)])]; _pos = []; _time = floor (serverTime); _pid = getPlayerUID player; if(isNil "_to" || isNull _to) exitWith {(localize "STR_ATM_NoneSelected") call zero_fnc_msg;}; if(!([(getPlayerUID _to)] call zero_fnc_isUIDActive)) exitWith {(localize "STR_CELL_Not_Online") call zero_fnc_msg;}; if(_msg == "") exitWith {(localize "STR_CELL_Title_Edit") call zero_fnc_msg;}; _exit = false; _chrByte = toArray (_msg); _allowed = toArray("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 0123456789ÄäÖöÜüß!#$()[]*+,-./<=>?@:&§^");
{if !(_x in _allowed) exitWith {(format ["Das Zeichen %1 ist in einer SMS nicht erlaubt", toString[_x]]) call zero_fnc_msg; _exit = true;}}forEach _chrByte; if(_exit) exitWith {}; [format ["MESSAGE SEND: %1 (%2, %3) hat Adminnachricht %4 an %5 (%6, %7) gesendet",player getVariable["zero_var_realname",getPlayerUID player], getPlayerUID player, playerSide,_msg, _to getVariable["zero_var_realname",name _to], getPlayerUID _to, side _to]] call zero_fnc_zoLog; [[6,_msg,name player,_pos,_time,_pid,player],"zero_fnc_cell_reciveMessage",_to] call zero_fnc_sendPacket; [] call zero_fnc_cellphone; [_msg,1,format ["Du hast %1 eine Nachricht gesendet",name _to]] call zero_fnc_msg; closeDialog 0;
