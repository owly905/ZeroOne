if (!hasInterface) exitWith {}; private["_msg","_to","_pos","_time","_pid","_chrByte","_allowed","_exit"]; if(({(side _x) isEqualTo independent} count playableUnits) == 0) exitWith {(localize "STR_CELL_No_medics") call zero_fnc_msg;}; _msg = ctrlText 3003; _to = localize "STR_CELL_EMSRequest_hint"; if(cbChecked ((findDisplay 3000) displayCtrl 3004)) then {_pos = position player;} else {_pos = [];}; _time = floor (serverTime); _pid = getPlayerUID player; if(_msg == "") exitWith {(localize "STR_CELL_Title_Edit") call zero_fnc_msg;}; _exit = false; _chrByte = toArray (_msg); _allowed = toArray('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 0123456789ÄäÖöÜüß!#$()[]*+,-./<=>?@:&§^');
{if !(_x in _allowed) exitWith {(format ["Das Zeichen %1 ist in einer SMS nicht erlaubt",toString[_x]]) call zero_fnc_msg; _exit = true;}}forEach _chrByte; if(_exit) exitWith {}; [format ["MESSAGE SEND: %1 (%2, %3) hat Notruf ""%4"" and die Feuerwehr gesendet",player getVariable["zero_var_realname",getPlayerUID player], getPlayerUID player,playerSide,_msg]] call zero_fnc_zoLog; [[2,_msg,name player,_pos,_time,_pid,player],"zero_fnc_cell_reciveMessage",independent] call zero_fnc_sendPacket; [[_msg,name player,_pos,_time,_pid,"medics"],"zero_fnc_addDispatch",zero_var_HC1_owner] call zero_fnc_sendPacket; [] call zero_fnc_cellphone; [_msg,1,format ["Du hast %1 eine Nachricht gesendet",_to]] call zero_fnc_msg; closeDialog 0;
