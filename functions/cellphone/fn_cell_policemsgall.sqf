if (!hasInterface) exitWith {}; private["_msg","_to","_pos","_time","_pid","_chrByte","_allowed","_exit"]; if((call zero_var_copLevel) <= 3 && call(zero_var_sekLevel) < 2) exitWith {(localize "STR_CELL_Not_Police") call zero_fnc_msg;}; params[["_isSek",false,[false]]]; _msg = ctrlText 3003; _to = localize "STR_CELL_AdminMSGAll_hint"; _pos = []; _time = floor (serverTime); _pid = getPlayerUID player; if(_msg == "") exitWith {(localize "STR_CELL_Title_Edit") call zero_fnc_msg;}; _exit = false; _chrByte = toArray (_msg); _allowed = toArray('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 0123456789ÄäÖöÜüß!#$()[]*+,-./<=>?@:&§^'); {if !(_x in _allowed) exitWith {(format ["Das Zeichen %1 ist in einer SMS nicht erlaubt",toString[_x]]) call zero_fnc_msg; _exit = true;}}forEach _chrByte; if(_exit) exitWith {};
if (_isSek) then { [format ["MESSAGE SEND: %1 (%2, %3) hat SEK Rundruf ""%4"" an alle gesendet",player getVariable["zero_var_realname",getPlayerUID player], getPlayerUID player,playerSide,_msg]] call zero_fnc_zoLog; [[8,_msg,name player,_pos,_time,_pid,player],"zero_fnc_cell_reciveMessage",(allPlayers - entities "HeadlessClient_F")] call zero_fnc_sendPacket; }else{ [format ["MESSAGE SEND: %1 (%2, %3) hat Polizeirundruf ""%4"" an alle gesendet",player getVariable["zero_var_realname",getPlayerUID player], getPlayerUID player,playerSide,_msg]] call zero_fnc_zoLog; [[4,_msg,name player,_pos,_time,_pid,player],"zero_fnc_cell_reciveMessage",(allPlayers - entities "HeadlessClient_F")] call zero_fnc_sendPacket; }; [] call zero_fnc_cellphone; [_msg,1,format ["Du hast %1 eine Nachricht gesendet",_to]] call zero_fnc_msg; closeDialog 0;
