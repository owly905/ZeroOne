if (!hasInterface) exitWith {}; private["_display","_curTarget","_Btn1","_Btn2","_Btn3","_Btn4","_Btn5","_Btn6","_Btn7","_Btn8","_Btn9","_Btn10","_Btn11","_Btn12","_Btn13"]; if(player getVariable["zero_var_restrained",false]) exitWith {}; if(!dialog) then { createDialog "zero_var_pInteraction_Menu"; }; disableSerialization; _curTarget = param[0,objNull,[objNull]]; if(isNull _curTarget || !isPlayer _curTarget) exitWith {closeDialog 0;}; _display = findDisplay 37400; _Btn1 = _display displayCtrl 37450; _Btn2 = _display displayCtrl 37451; _Btn3 = _display displayCtrl 37452; _Btn4 = _display displayCtrl 37453; _Btn5 = _display displayCtrl 37454; _Btn6 = _display displayCtrl 37455; _Btn7 = _display displayCtrl 37456; _Btn8 = _display displayCtrl 37457; _Btn9 = _display displayCtrl 37458; _Btn10 = _display displayCtrl 37459; _Btn11 = _display displayCtrl 37460; _Btn12 = _display displayCtrl 37461; _Btn13 = _display displayCtrl 37462; _Btn5 ctrlShow false; _Btn6 ctrlShow false; _Btn7 ctrlShow false; _Btn8 ctrlShow false; _Btn9 ctrlShow false; _Btn10 ctrlShow false; _Btn11 ctrlShow false; _Btn12 ctrlShow false; _Btn13 ctrlShow false; zero_var_pInact_curTarget = _curTarget; if (isNil "zero_var_escort") then { _Btn1 ctrlEnable true; _Btn1 ctrlSetText localize "STR_pInAct_Unrestrain"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_unrestrain; closeDialog 0; zero_var_escort = nil;zero_var_action_inUse = false;"; } else { _Btn1 ctrlEnable false; }; if((_curTarget getVariable["zero_var_escorting",false])) then { _Btn2 ctrlSetText localize "STR_pInAct_StopEscort"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_stopEscorting; [zero_var_pInact_curTarget] call zero_fnc_medInteractionMenu; zero_var_escort = nil;zero_var_action_inUse = false;";
} else { _Btn2 ctrlSetText localize "STR_pInAct_Escort"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_escortAction; closeDialog 0;zero_var_action_inUse = false;"; }; _Btn3 ctrlSetText localize "STR_pInAct_PutInCar"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] call zero_fnc_putInCar; zero_var_escort = nil; closeDialog 0; zero_var_action_inUse = false;"; if(_curTarget getVariable["zero_var_restrained",false]) then { _Btn1 ctrlEnable true; _Btn2 ctrlEnable true; _Btn3 ctrlEnable true; }else{ _Btn1 ctrlEnable false; _Btn2 ctrlEnable false; _Btn3 ctrlEnable false; }; _Btn4 ctrlSetText "Alkoholkontrolle"; _Btn4 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[[clientOwner],""zero_fnc_breathalyzer"",zero_var_pInact_curTarget] call zero_fnc_sendPacket; closeDialog 0;zero_var_action_inUse = false;"; [_curTarget] spawn { disableSerialization; if !(params [["_player", objNull, [objNull]]]) exitWith {}; private _distance = ((boundingBox _player select 1) select 0) + 3; waitUntil {sleep 0.5; _player distance player > _distance || {isNull (findDisplay 37400)}}; if !(isNull (findDisplay 37400)) then { closeDialog 0; closeDialog 0; }; };
