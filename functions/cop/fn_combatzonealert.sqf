private _mode = param[0,0,[0]]; private _position = param[1,[],[[]]]; if (_mode isEqualTo 0) then { while {dialog} do {closeDialog 0; uiSleep 0.1}; openMap [true, true]; onMapSingleClick { onMapSingleClick {}; [1,_pos] spawn zero_fnc_combatZoneAlert; openMap [false, false]; true; }; }else{ if (_position isEqualTo []) exitWith {}; private _localMarker = createMarkerLocal[format["local_combatzone_",_position],_position]; _localMarker setMarkerColorLocal "ColorRed"; _localMarker setMarkerShapeLocal "ELLIPSE"; _localMarker setMarkerBrushLocal "SolidBorder"; _localMarker setMarkerAlphaLocal 1; _localMarker setMarkerSizeLocal [500,500]; private _localMarkerText = createMarkerLocal [format["local_combatzone_text_%1", _position],_position]; _localMarkerText setMarkerColorLocal "ColorWhite"; _localMarkerText setMarkerTypeLocal "mil_warning"; _localMarkerText setMarkerTextLocal "!!! Kampfgebiet !!!"; _localMarkerText setMarkerSizeLocal [1, 1]; openMap [true, true]; private _messagePosition = [_position select 0, (_position select 1) - 1500, _position select 2]; mapAnimAdd [0.5, 0.15,_messagePosition]; mapAnimCommit; private _action = [ format["Soll an dieser Position %1 ein Kampfgebiet ausgerufen werden?",mapGridPosition _position], "Kampfgebietswarnung", localize "STR_Global_Yes", localize "STR_Global_No" ] call BIS_fnc_guiMessage; if (!_action) exitWith { deleteMarkerLocal _localMarker; deleteMarkerLocal _localMarkerText; _action = [ format["Soll an dieser Position %1 ein Kampfgebiet entfernt werden?",mapGridPosition _position], "Kampfgebietswarnung", localize "STR_Global_Yes", localize "STR_Global_No" ] call BIS_fnc_guiMessage;
if (!_action) exitWith {openMap [false, false];}; private _markerToDelete = 0; { if(_x find "zero_var_combatzone_" != -1 && {_position distance (getMarkerPos _x) < 300}) then { deleteMarker _x; _markerToDelete = _markerToDelete + 1; }; if (_markerToDelete >= 2) exitWith {}; } forEach allMapMarkers; if (_markerToDelete isEqualTo 0) exitWith { "Kein Kampfgebiet gefunden!" call zero_fnc_msg; openMap[false, false]; }; [format['Kampfgebiet %1 wurde entfernt',mapGridPosition _position],1] call zero_fnc_msg; openMap [false, false]; }; deleteMarkerLocal _localMarker; deleteMarkerLocal _localMarkerText; [[player, "zero_var_fnc_createMarker", [format["zero_var_combatzone_%1_%2", _position, serverTime],_position]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; waitUntil {!isNil "zero_var_createMarkerResponse"}; private _marker = zero_var_createMarkerResponse; zero_var_createMarkerResponse = nil; _marker setMarkerColor "ColorRed"; _marker setMarkerShape "ELLIPSE"; _marker setMarkerBrush "SolidBorder"; _marker setMarkerAlpha 1; _marker setMarkerSize [500,500]; [[player, "zero_var_fnc_createMarker", [format["%1_text", _marker],_position]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; waitUntil {!isNil "zero_var_createMarkerResponse"}; _marker = zero_var_createMarkerResponse; zero_var_createMarkerResponse = nil; _marker setMarkerColor "ColorWhite"; _marker setMarkerType "mil_warning"; _marker setMarkerText "!!! Kampfgebiet !!!"; _marker setMarkerSize [1, 1]; ["Kampfgebiet wurde ausgerufen",1] call zero_fnc_msg; openMap [false, false]; };
