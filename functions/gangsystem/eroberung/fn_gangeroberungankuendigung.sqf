if (!hasInterface) exitWith {}; private["_group","_announce","_time"]; if(serverTime < 600) exitWith {"Du kannst eine Ankündigung erst 10min nach Restart senden!" call zero_fnc_msg;}; if((group player) getVariable["zero_var_gang",[]] isEqualTo []) exitWith {"Du bist in keiner Gang!" call zero_fnc_msg;}; if(count (((group player) getVariable["zero_var_gang",[nil,nil,nil,0]]) select 3) < 10) exitWith {"Deine Gang braucht mindestens 10 Mitglieder!" call zero_fnc_msg;}; if((group player) getVariable["zero_var_gangAnnounce",false]) exitWith {"Deine Gang hat bereits eine Ankündigung gesendet!" call zero_fnc_msg;}; if(zero_gang_flag getVariable["zero_var_gangFight",-1] > 0) exitWith {"Du kannst keine Anküdigung senden, da der Kampf bereits begonnen hat." call zero_fnc_msg;}; if(zero_gang_flag getVariable["zero_var_gangFightEnded",false]) exitWith {"Der Kampf um die Gangeroberung ist für diesen Tag beendet!" call zero_fnc_msg;}; if(!isNull (zero_gang_flag getVariable ["zero_var_gangControlGroup",grpNull]) && {(group player) == (zero_gang_flag getVariable ["zero_var_gangControlGroup",grpNull])}) exitWith {"Du besitzt bereits die Gangeroberung!" call zero_fnc_msg;}; _group = zero_gang_flag getVariable["zero_var_gangControlGroup",grpNull]; _time = 10; _announce = zero_gang_flag getVariable "zero_var_gangAnnounce"; if(isNil "_announce") then { zero_gang_flag setVariable["zero_var_gangAnnounce",[serverTime,[(group player)]],true]; if(!isNull _group) then {[[_time,true],"zero_fnc_gangEroberungTimer",units _group,false] call zero_fnc_sendPacket;
}; [[_time,true],"zero_fnc_gangEroberungTimer",units(group player),false] call zero_fnc_sendPacket; }else{ { if(!isNull _x && count(units _x) > 0) then { [[7,format["%1 kündigt einen Angriff auf die Gangeroberung an!",(group player) getVariable["zero_var_gang",[]] select 1],(group player) getVariable["zero_var_gang",[]] select 1,[],floor (serverTime),getPlayerUID player,player],"zero_fnc_cell_reciveMessage",units(_x)] call zero_fnc_sendPacket; }; } forEach (_announce select 1); (_announce select 1) pushBackUnique (group player); zero_gang_flag setVariable["zero_var_gangAnnounce",_announce,true]; [[((_time*60)-(serverTime - (_announce select 0)))/60,true],"zero_fnc_gangEroberungTimer",units(group player),false] call zero_fnc_sendPacket; }; if(!isNull _group) then { [[7,format["%1 kündigt einen Angriff auf die Gangeroberung an!",(group player) getVariable["zero_var_gang",[]] select 1],(group player) getVariable["zero_var_gang",[]] select 1,[],floor (serverTime),getPlayerUID player,player],"zero_fnc_cell_reciveMessage",units _group] call zero_fnc_sendPacket; _announce = zero_gang_flag getVariable "zero_var_gangAnnounce"; (_announce select 1) pushBackUnique (_group); zero_gang_flag setVariable["zero_var_gangAnnounce",_announce,true]; _group setVariable["zero_var_gangAnnounce",true,true]; }; (group player) setVariable["zero_var_gangAnnounce",true,true]; [] call zero_fnc_cellphone; ["Warte mit dem Angriff bis der Timer abgelaufen ist!",1,"Du hast eine Ankündigung gesendet!"] call zero_fnc_msg; closeDialog 0;
