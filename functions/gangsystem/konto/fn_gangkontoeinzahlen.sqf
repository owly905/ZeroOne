if (!hasInterface) exitWith {}; private["_group","_gang","_konto","_display","_betrag","_number"]; disableSerialization; _group = (group player); _gang = _group getVariable ["zero_var_gang",[]]; if(_gang isEqualTo []) exitWith {"Du bist in keiner Gang" call zero_fnc_msg;}; if(!isNull (_group getVariable["zero_var_gangKontoInUse",objNull])) exitWith {"Auf das Gangkonto wird bereits zugegriffen!" call zero_fnc_msg;}; if(count _gang < 7) exitWith {"Es ist ein Fehler aufgetreten" call zero_fnc_msg;}; _konto = _gang select 5; _display = findDisplay 2700; if (isNull _display) exitWith {}; _betrag = _display displayCtrl 2702; _betrag = ctrlText _betrag; _number = parseNumber(_betrag); if(_konto > 60000000) exitWith {"Das Gangkonto hat bereits den Maximalbetrag von 60 Millionen!" call zero_fnc_msg;}; if(_number > 999999) exitWith {(localize "STR_ATM_TransferMax") call zero_fnc_msg;}; if(_number <= 0) exitWith {"Du musst mehr als 0€ überweisen" call zero_fnc_msg;}; if(!([_betrag] call zero_fnc_isNumber)) exitWith {(localize "STR_AIM_notnumeric") call zero_fnc_msg;
}; if(_number > ([2, 0] call zero_fnc_Z0Check)) exitWith {(localize "STR_ATM_NotEnoughCash") call zero_fnc_msg;}; [0, ([2, 0] call zero_fnc_Z0Check) - (_number)] call zero_fnc_Z0Check; [1] call zero_fnc_updatePartial; [format ["GANG DEPOSIT: %1 (%2, %3) hat %4 in das Gangkonto der Gang %5 eingezahlt. Vorher %6, nachher %7", player getVariable["zero_var_realname", name player], getPlayerUID player,playerSide, [_number] call zero_fnc_numberText, _gang select 1,[_konto] call zero_fnc_numberText,[_konto + _number] call zero_fnc_numberText]] call zero_fnc_zoLog; _gang set[5,_konto + _number]; _group setVariable["zero_var_gang",_gang,true]; if(isNil "zero_var_gangKontoUpdate") then { zero_var_gangKontoUpdate = true; [] spawn { private _time = serverTime + 10; waitUntil {isNull (findDisplay 2700) || (serverTime >= _time)}; _gang = (group player) getVariable ["zero_var_gang",[]]; [[clientOwner,1,[_gang select 0,_gang select 5]],"zero_fnc_updateGang",zero_var_HC1_owner,false] call zero_fnc_sendPacket; zero_var_gangKontoUpdate = nil; }; }; [format[localize "STR_ATM_DepositGang",_betrag],1] call zero_fnc_msg; [] call zero_fnc_atmMenuUpdate;
