if (!hasInterface) exitWith {}; private["_display","_streifenList","_einheitenList","_streife","_rank","_map","_pos","_marker","_fnc_getRank"]; disableSerialization; _display = findDisplay 3400; if (isNull _display) exitWith {}; _streifenList = _display displayCtrl 3404; _einheitenList = _display displayCtrl 3405; _map = _display displayCtrl 3407; _streife = lbData[3404,lbCurSel(3404)]; lbClear _einheitenList; _fnc_getRank = { _rank = ""; if(playerSide isEqualTo west) then { _rank = switch ((_this getVariable ["zero_var_rank",0])) do { case 2: {"[Wachtmeister]"}; case 3: {"[Oberwachtmeister]"}; case 4: {"[Hauptwachtmeister]"}; case 5: {"[Kommissar]"}; case 6: {"[Oberkommissar]"}; case 7: {"[Hauptkommissar]"}; case 8: {"[Polizeirat]"}; case 9: {"[Polizeidirektor]"}; default {"[AnwÃ¤rter]"}; }; }else{ _rank = switch (_this getVariable ["zero_var_rank",0]) do { case 1: {"[Feuerwehrmann-Anw]"};
case 2: {"[Feuerwehrmann]"}; case 3: {"[Oberfeuerwehrmann]"}; case 4: {"[Unterbrandmeister]"}; case 5: {"[Brandmeister]"}; case 6: {"[Oberbrandmeister]"}; case 7: {"[Wehrleitung]"}; default {"[Feuerwehr]"}; }; }; _rank; }; _pos = []; { if(isPlayer _x && alive _x && (_x getVariable["zero_var_streife",""] isEqualTo _streife)) then { _einheitenList lbAdd format ["%1 %2",_x call _fnc_getRank, _x getVariable["zero_var_realname",name _x]]; _einheitenList lbSetData[(lbSize _einheitenList)-1,str(_x)]; _pos = getPos _x; }; } forEach units(group player); if(lbSize _einheitenList > 0) then { lbSort _einheitenList; [_map,0,0.03,_pos] call zero_fnc_setMapPosition; _marker = createMarkerLocal [_streife, _pos]; _marker setMarkerColorLocal "ColorBlue"; _marker setMarkerTypeLocal "mil_box"; _marker setMarkerTextLocal _streife; _streife spawn { waitUntil {_this != lbData[3404,lbCurSel(3404)] || isNull (findDisplay 3400)}; deleteMarkerLocal _this; }; };
