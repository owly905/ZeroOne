if (!hasInterface) exitWith {}; private ["_display","_title","_streifenListTitle","_einheitenListTitle","_streifenList","_einheitenList","_description","_streifen","_index","_map","_text","_streifenListDefinition","_combatZoneButton"]; createDialog "zero_var_streifensys"; disableSerialization; _display = findDisplay 3400; if (isNull _display) exitWith {}; _title = _display displayCtrl 3401; _streifenListTitle = _display displayCtrl 3402; _einheitenListTitle = _display displayCtrl 3403; _streifenList = _display displayCtrl 3404; _einheitenList = _display displayCtrl 3405; _description = _display displayCtrl 3406; _map = _display displayCtrl 3407; _combatZoneButton = _display displayCtrl 3408; if(playerSide != west || {player getVariable["zero_var_rank",0] <= 3}) then { _combatZoneButton ctrlEnable false; _combatZoneButton ctrlShow false; }; [_map,0,0.03,getPos player] call zero_fnc_setMapPosition; if(playerSide isEqualTo west) then { _title ctrlSetStructuredText parseText format["<t align='center' size='1.5'>Polizei Streifensystem</t>"]; _streifenListTitle ctrlSetStructuredText parseText format["<t align='center' size='1.25'>Streifen</t>"]; _einheitenListTitle ctrlSetStructuredText parseText format["<t align='center' size='1.25'>Einheiten</t>"]; _description ctrlSetStructuredText parseText format["<t underline=true>Steuerung:</t><br/>Streife beitreten: Doppelklick auf die Streife in der Streifenliste<br/>Streife verlassen: Doppelklick auf den Spieler in der Einheitenliste<br/>"]; }else{ _title ctrlSetStructuredText parseText format["<t align='center' size='1.5'>Feuerwehr Streifensystem</t>"];
_streifenListTitle ctrlSetStructuredText parseText format["<t align='center' size='1.25'>Streifen</t>"]; _einheitenListTitle ctrlSetStructuredText parseText format["<t align='center' size='1.25'>Einheiten</t>"]; _description ctrlSetStructuredText parseText format["<t underline=true>Steuerung:</t><br/>Streife beitreten: Doppelklick auf die Streife in der Streifenliste<br/>Streife verlassen: Doppelklick auf den Spieler in der Einheitenliste<br/>"]; }; lbClear _streifenList; lbClear _einheitenList; _streifen = []; { if(isPlayer _x && !(_x getVariable["zero_var_streife",""] isEqualTo "")) then { _index = [_x getVariable "zero_var_streife",_streifen] call zero_fnc_findIndex; if(_index != -1) then { _streifen set[_index,[(_streifen select _index) select 0,((_streifen select _index) select 1) +1]]; }else{ _streifen pushBack [_x getVariable "zero_var_streife",1]; }; }; } forEach units(group player); _streifenListDefinition = if (playerSide isEqualTo west) then { getArray(missionConfigFile >> "zero_CfgPatrolSystem" >> "police" >> "patrols"); } else { getArray(missionConfigFile >> "zero_CfgPatrolSystem" >> "firefighter" >> "patrols"); }; _text = ""; { _text = format ["%1 (%2)", _x select 0, _x select 1]; _index = [_x select 1,_streifen] call zero_fnc_findIndex; if(_index != -1) then { _text = parseText format ["%1 - %2", _text, (_streifen select _index) select 1]; }else{ _text = format ["%1 - 0", _text]; }; _streifenList lbAdd format["%1",_text]; _streifenList lbSetData [(lbSize _streifenList)-1,(_x select 1)]; } forEach _streifenListDefinition;
