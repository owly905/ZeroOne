private _itemList = []; private _loadoutToFetch =_this; private _handleWeapon = { if (_this isEqualTo []) exitWith {}; { switch (true) do { case (_forEachIndex in [0,1,2,3,6] && {_x != ""}): { _itemList pushBack _x; }; case (_forEachIndex in [4,5] && {!(_x isEqualTo [])}): { _x call _handleAmmoLoaded; }; }; } forEach _this; }; private _handleAmmoLoaded = { [_this select 0, 1, _this select 1] call _handleAmmo; }; private _handleAmmo = { private _ammoType = _this select 0; private _ammo = _this select 2; private _maxAmmo = getNumber(configfile >> "CfgMagazines" >> _ammoType >> "count"); if (_ammo == _maxAmmo) then { for [{_i=0}, {_i!=(_this select 1)}, {_i=_i+1}] do { _itemList pushBack _ammoType; }; }; }; private _handleItem = { for [{_i=0}, {_i!=(_this select 1)}, {_i=_i+1}] do { _itemList pushBack (_this select 0);
}; }; private _handleClothing = { if (_this isEqualTo []) exitWith {}; _itemList pushBack (_this select 0); { switch (true) do { case ((count _x == 2) && {(_x select 1) isEqualType 0}): { _x call _handleItem; }; case (count _x == 3): { _x call _handleAmmo; }; case ((count _x == 2) && {(_x select 1) isEqualType false}): { if (_x select 1) then { } else { [_x select 0,1] call _handleItem; }; }; case ((count _x) == 7): { _x call _handleWeapon; }; default { }; }; } forEach (_this select 1); }; { (_loadoutToFetch select _x) call _handleWeapon; } forEach [0,1,2,8]; { (_loadoutToFetch select _x) call _handleClothing; } forEach [3,4,5]; { if ((_loadoutToFetch select _x) != "") then { _itemList pushBack (_loadoutToFetch select _x); }; } forEach [6,7]; { if (_x != "") then { _itemList pushBack _x; }; } forEach (_loadoutToFetch select 9); _itemList
