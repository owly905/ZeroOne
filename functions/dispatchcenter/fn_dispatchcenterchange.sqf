disableSerialization; if ( !hasInterface || ( playerSide isEqualTo civilian ) || ( playerSide isEqualTo east ) ) exitWith {}; private["_selection","_list","_position","_from","_positionscript","_sortArr"]; _selection = param[1,0,[0]]; zero_var_last_dispatch_seclection = _selection; _list = ((findDisplay 4000) displayCtrl 4004); lbClear _list; private _dispatches = []; if( playerSide isEqualTo west ) then { _dispatches = zero_var_cop_dispatches; } else { _dispatches = zero_var_med_dispatches; }; if (_selection isEqualTo 4 || _selection isEqualTo 5) then { { if (count(_x select 2) != 0) then { _position = floor ((_x select 2) distance player); } else { _position = -1; }; _x deleteAt 5; _x pushBack _position; } forEach _dispatches; }; switch (_selection) do { case 0 : { lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; { _from = _x select 1; _list lbAdd format["%1", _from]; _list lbSetData [(lbSize _list)-1,str(_x)]; } forEach _dispatches; }; case 1 : { _sortArr = [_dispatches, 3, "desc"] call KRON_ArraySort; lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; { _from = _x select 1; _list lbAdd format["%1", _from]; _list lbSetData [(lbSize _list)-1,str(_x)]; } forEach _sortArr; }; case 2: { _sortArr = [_dispatches, 1] call KRON_ArraySort; lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; };
{ _from = _x select 1; _list lbAdd format["%1", _from]; _list lbSetData [(lbSize _list)-1,str(_x)]; } forEach _sortArr; }; case 3: { _sortArr = [_dispatches, 1, "desc"] call KRON_ArraySort; lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; { _from = _x select 1; _list lbAdd format["%1", _from]; _list lbSetData [(lbSize _list)-1,str(_x)]; } forEach _sortArr; }; case 4: { _sortArr = [_dispatches, 5] call KRON_ArraySort; lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; { if (_x select 5 != -1) then { _from = _x select 1; _positionscript = _x select 5; _list lbAdd format["%1 - %2M", _from, _positionscript]; _list lbSetData [(lbSize _list)-1,str(_x)]; }; } forEach _sortArr; }; case 5: { _sortArr = [_dispatches, 5, "desc"] call KRON_ArraySort; lbClear _list; if (_dispatches isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; { if (_x select 5 != -1) then { _from = _x select 1; _positionscript = _x select 5; _list lbAdd format["%1 - %2M", _from, _positionscript]; _list lbSetData [(lbSize _list)-1,str(_x)]; }; } forEach _sortArr; }; case 6 : { lbClear _list; _sortArr = []; { if(toLower(_x select 1) find toLower(ctrlText 4002) != -1) then {_sortArr pushBack _x;}; } forEach _dispatches; if (_sortArr isEqualTo []) exitWith { _list lbAdd localize "STR_PM_DispatchCenter_no_diaptches"; _list lbSetData [(lbSize _list)-1,"Null"]; }; lbClear _list; { _list lbAdd format["%1", _x select 1]; _list lbSetData [(lbSize _list)-1,str(_x)]; } forEach _sortArr; }; };
