if (!hasInterface) exitWith {}; private["_ui","_units","_text","_idc","_pos","_sPos","_distance"]; if(visibleMap || {!alive player} || {dialog} || {zero_var_isFlashed}) exitWith {500 cutText["","PLAIN"];}; _ui = uiNamespace getVariable ["zero_var_HUD_nameTags",displayNull]; if(isNull _ui) then { 500 cutRsc["zero_var_HUD_nameTags","PLAIN"]; _ui = uiNamespace getVariable ["zero_var_HUD_nameTags",displayNull]; }; _units = nearestObjects[(visiblePosition player),["Man"],50]; _units = _units - [player]; { _idc = _ui displayCtrl (78000 + _forEachIndex); if(!(lineIntersects [eyePos player, eyePos _x, player, _x]) && {!isNil {_x getVariable "zero_var_realname"}} && {!isObjectHidden _x}) then { if (side _x isEqualTo west && goggles _x in ["G_Balaclava_blk","G_Bandanna_blk","G_Balaclava_TI_blk_F"]) exitWith {_idc ctrlShow false;}; _pos = [visiblePosition _x select 0, visiblePosition _x select 1, ((_x modelToWorld (_x selectionPosition "head")) select 2)+.5]; _sPos = worldToScreen _pos; _distance = _pos distance player; if(count _sPos > 1 && {_distance < 15}) then { _text = switch (true) do { case (_x in (units (group player)) && ((side _x) in [civilian, east])): { if(_x getVariable["zero_var_noob",false]) then { format["<t color='#00FF00'><t color='#00FF00'>[Neuling]</t> %1</t>",(_x getVariable "zero_var_realname")]; } else { format["<t color='#00FF00'>%1</t>",(_x getVariable "zero_var_realname")]; }; }; case (!isNil {(_x getVariable "zero_var_rank")} && (side _x) isEqualTo west): { if(_x getVariable["zero_var_streife",""] in ["ZIV1","ZIV2"]) then { _x getVariable "zero_var_realname" }else{ format["<img image='%1' size='1'></img> <t size='1.2' color='#0054A4'>%3<br/></t>%2", switch (_x getVariable "zero_var_rank") do { case 2: {"\a3\ui_f\data\gui\cfg\Ranks\corporal_gs.paa"}; case 3: {"\a3\ui_f\data\gui\cfg\Ranks\sergeant_gs.paa"}; case 4: {"Resources\Textures\Icons\hwm.paa"}; case 5: {"\a3\ui_f\data\gui\cfg\Ranks\lieutenant_gs.paa"}; case 6: {"\a3\ui_f\data\gui\cfg\Ranks\captain_gs.paa"}; case 7: {"\a3\ui_f\data\gui\cfg\Ranks\major_gs.paa"}; case 8: {"\a3\ui_f\data\gui\cfg\Ranks\general_gs.paa"}; case 9: {"\a3\ui_f\data\gui\cfg\Ranks\colonel_gs.paa"}; default {"\a3\ui_f\data\gui\cfg\Ranks\private_gs.paa"}; }, _x getVariable "zero_var_realname", switch ((_x getVariable "zero_var_rank")) do { case 2: {"Wachtmeister"}; case 3: {"Oberwachtmeister"}; case 4: {"Hauptwachtmeister"}; case 5: {"Kommissar"}; case 6: {"Oberkommissar"};
case 7: {"Hauptkommissar"}; case 8: {"Polizeirat"}; case 9: {"Polizeidirektor"}; default {"Anw√§rter"}; } ] }; }; case ((!isNil {_x getVariable "zero_var_realname"} && (side _x) isEqualTo independent)): { format["%2<br/>%1", _x getVariable "zero_var_realname", switch (_x getVariable "zero_var_rank") do { case 1: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Feuerwehrmann-Anw</t>"}; case 2: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Feuerwehrmann</t>"}; case 3: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Oberfeuerwehrmann</t>"}; case 4: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Unterbrandmeister</t>"}; case 5: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Brandmeister</t>"}; case 6: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Oberbrandmeister</t>"}; case 7: {"<t color='#FF0000'><img image='a3\ui_f\data\map\MapControl\hospital_ca.paa' size='1.5'></img></t><t size='0.8' color='#EDF5F5'>Wehrleitung</t>"}; default {"Feuerwehr"}; } ]; }; case (_x isEqualTo nsa) : {"Agent Orange"}; default { if !((group _x getVariable["zero_var_gang",[]]) isEqualTo []) then { if(_x getVariable["zero_var_noob",false]) then { format["<t color='#00FF00'>[Neuling]</t> %1<br/><t size='0.9' color='#B6B6B6'>%2</t>",_x getVariable "zero_var_realname",((group _x) getVariable "zero_var_gang") select 1]; } else { format["%1<br/><t size='0.9' color='#B6B6B6'>%2</t>",_x getVariable "zero_var_realname",((group _x) getVariable "zero_var_gang") select 1]; }; } else { if(_x getVariable["zero_var_noob",false]) then { format["<t color='#00FF00'>[Neuling]</t> %1",_x getVariable "zero_var_realname"]; } else { _x getVariable "zero_var_realname"; }; }; }; }; if(_x getVariable ["zero_var_speaking",false]) then { _text = format ["<img image='\A3\ui_f\data\igui\rscingameui\rscdisplayvoicechat\microphone_ca.paa' size='1.5'></img>"] + _text; }; _idc ctrlSetStructuredText parseText _text; _idc ctrlSetPosition [_sPos select 0, _sPos select 1, 0.4, 0.65]; _idc ctrlSetScale 0.8; _idc ctrlSetFade 0; _idc ctrlCommit 0; _idc ctrlShow true; } else { _idc ctrlShow false; }; } else { _idc ctrlShow false; }; } forEach _units;
