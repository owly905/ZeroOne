if (!hasInterface) exitWith {}; private["_savePlayer","_savePlayerLast","_forceSynced","_fnc_food","_fnc_water","_fnc_packCheck","_waterTime","_waterTimeLast","_foodTime","_foodTimeLast","_playerTime","_playerTimeLast","_backpack","_curCash","_damage","_fnc_checkMoney","_moneyCheckLast","_moneyCheck","_fnc_deleteObject","_objectCheck","_objectCheckLast","_data","_isWater","_isWaterLast"]; if(playerSide isEqualTo west && (call (zero_var_copLevel) < 1)) exitWith { 0 cutText ["","BLACK FADED"]; 0 cutFadeOut 99999999; ["NotWhitelisted"] call bis_fnc_endMission; zero_var_paycheck = 0; }; [] spawn zero_fnc_staminaSkill; _fnc_water = { if(zero_var_thirst < 2) exitWith { [[player, "zero_var_fnc_setDamage", [player, 1.914672]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; [format ["VERDURSTET: %1 (%2,%3) ist verdurstet.", player getVariable ["zero_var_realname", name player], getPlayerUID player, playerSide]] call zero_fnc_zoLog; [localize "STR_NOTF_DrinkMSG_Death",-1] call zero_fnc_msg; }; zero_var_thirst = zero_var_thirst - 10; [] call zero_fnc_hudUpdate; if(zero_var_thirst < 2) exitWith { [[player, "zero_var_fnc_setDamage", [player, 1.914672]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; [format ["VERDURSTET: %1 (%2,%3) ist verdurstet.", player getVariable ["zero_var_realname", name player], getPlayerUID player, playerSide]] call zero_fnc_zoLog; [localize "STR_NOTF_DrinkMSG_Death",-1] call zero_fnc_msg; }; switch(zero_var_thirst) do { case 30: { [localize "STR_NOTF_DrinkMSG_1",1] call zero_fnc_msg; titleText[localize "STR_NOTF_DrinkMSG_1","PLAIN"]; }; case 20: { [localize "STR_NOTF_DrinkMSG_2",1] call zero_fnc_msg; player setFatigue 1; titleText[localize "STR_NOTF_DrinkMSG_2","PLAIN"]; }; case 10: { [localize "STR_NOTF_DrinkMSG_3",1] call zero_fnc_msg; player setFatigue 1; titleText[localize "STR_NOTF_DrinkMSG_3","PLAIN"]; [] spawn { "chromAberration" ppEffectEnable true; "radialBlur" ppEffectEnable true; enableCamShake true; for "_i" from 0 to 9 do { "chromAberration" ppEffectAdjust [random 0.25,random 0.25,true]; "chromAberration" ppEffectCommit 1; "radialBlur" ppEffectAdjust [random 0.02,random 0.02,0.15,0.15]; "radialBlur" ppEffectCommit 1; addCamShake[random 3, 1, random 3]; uiSleep 1; }; "chromAberration" ppEffectAdjust [0,0,true]; "chromAberration" ppEffectCommit 5; "radialBlur" ppEffectAdjust [0,0,0,0]; "radialBlur" ppEffectCommit 5; uiSleep 6; "chromAberration" ppEffectEnable false; "radialBlur" ppEffectEnable false; resetCamShake; }; }; }; }; _fnc_food = { if(zero_var_hunger < 2) exitWith { [[player, "zero_var_fnc_setDamage", [player, 1.914672]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; [localize "STR_NOTF_EatMSG_Death",-1] call zero_fnc_msg; }; zero_var_hunger = zero_var_hunger - 10; [] call zero_fnc_hudUpdate; if(zero_var_hunger < 2) exitWith { [[player, "zero_var_fnc_setDamage", [player, 1.914672]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; [localize "STR_NOTF_EatMSG_Death",-1] call zero_fnc_msg; }; switch(zero_var_hunger) do { case 30: { [localize "STR_NOTF_EatMSG_1",1] call zero_fnc_msg; titleText[localize "STR_NOTF_EatMSG_1","PLAIN"];}; case 20: { [localize "STR_NOTF_EatMSG_2",1] call zero_fnc_msg; titleText[localize "STR_NOTF_EatMSG_2","PLAIN"];}; case 10: { [localize "STR_NOTF_EatMSG_3",1] call zero_fnc_msg; titleText[localize "STR_NOTF_EatMSG_3","PLAIN"]; player setFatigue 1; [] spawn { "chromAberration" ppEffectEnable true; "radialBlur" ppEffectEnable true; enableCamShake true; for "_i" from 0 to 9 do { "chromAberration" ppEffectAdjust [random 0.25,random 0.25,true]; "chromAberration" ppEffectCommit 1; "radialBlur" ppEffectAdjust [random 0.02,random 0.02,0.15,0.15]; "radialBlur" ppEffectCommit 1; addCamShake[random 3, 1, random 3]; uiSleep 1; }; "chromAberration" ppEffectAdjust [0,0,true]; "chromAberration" ppEffectCommit 5; "radialBlur" ppEffectAdjust [0,0,0,0]; "radialBlur" ppEffectCommit 5; uiSleep 6; "chromAberration" ppEffectEnable false; "radialBlur" ppEffectEnable false; resetCamShake; }; if(zero_var_drink > 0) then {zero_var_drink = zero_var_drink - 0.15;}else{zero_var_drink = 0;}; if(zero_var_drink <= 0.6 && zero_var_hunger > 10) then { "chromAberration" ppEffectEnable false; "radialBlur" ppEffectEnable false; "colorCorrections" ppEffectEnable false; }; }; }; }; _fnc_packCheck = { [format ["MONEY LOG: %1 (%2, %3) besitzt %4 insgesamt. Bar: %5, Bank: %6", player getVariable["zero_var_realname",name player], getPlayerUID player, playerSide, [(([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check))] call zero_fnc_numberText, [([3, 0] call zero_fnc_Z0Check)] call zero_fnc_numberText, [([2, 0] call zero_fnc_Z0Check)] call zero_fnc_numberText]] call zero_fnc_zoLog; if (zero_var_playerSide isEqualTo east) exitWith {}; [0, ([2, 0] call zero_fnc_Z0Check) + (call zero_var_paycheck)] call zero_fnc_Z0Check; systemChat format [localize "STR_FSM_ReceivedPay",[(call zero_var_paycheck)] call zero_fnc_numberText]; systemChat format [localize "STR_FSM_Paycheck",10]; }; _fnc_checkMoney = { if((([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check) - _this) > 499999) then { [format ["SUSPICOUS MONEY: %1 (%2, %3) sprang von %4 zu %5. Differenz %6", player getVariable["zero_var_realname",name player], getPlayerUID player, playerSide, [_this] call zero_fnc_numberText, [(([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check))] call zero_fnc_numberText, [(([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check) - _this)] call zero_fnc_numberText]] call zero_fnc_zoLog; }; }; _fnc_deleteObject = { { if(damage _x >= 1) then { _x hideObject true; }; } forEach (nearestTerrainObjects [player,["TREE","SMALL TREE","BUSH","FENCE","WALL","POWER LINES","HIDE"],50,false]); }; if((zero_var_onlineTime < 900) && !(player getVariable["zero_var_noob",false])) then { player setVariable["zero_var_noob",true,true]; } else { if((zero_var_onlineTime >= 900) && (player getVariable["zero_var_noob",false])) then { player setVariable["zero_var_noob",nil,true]; }; }; if(isNil "zero_var_init_survival_ready") then {zero_var_init_survival_ready = true;}; zero_var_distanceCooldown = serverTime; zero_var_viewState = false; _waterTime = 400; _waterTimeLast = serverTime; _foodTime = 550; _foodTimeLast = serverTime; _playerTime = 600; _playerTimeLast = serverTime; _moneyCheck= 3; _moneyCheckLast = serverTime; _objectCheck = 20; _objectCheckLast = serverTime; _savePlayer = 30; _savePlayerLast = serverTime; _isWater = 30; _isWaterLast = serverTime; private _fCheck = 120; private _fCheckLast = serverTime; _backpack = backpack player; _damage = damage player; _curCash = ([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check); _forceSynced = false; _onlinetime = 0; for "_i" from 0 to 1 step 0 do { if(!isNull(findDisplay 175462)) then { { if(_x != player) then {_x hideObject true;}; true; } count (player nearEntities ["Man", 250]); }; if((serverTime - _waterTimeLast) >= _waterTime) then { call _fnc_water; _waterTimeLast = serverTime; enableRadio false; enableSentences false; 0 enableChannel [false,false]; if(zero_var_sidechat) then { 1 enableChannel [true,false]; } else { 1 enableChannel [false,false]; }; 2 enableChannel [false,false]; 3 enableChannel [true,true]; 4 enableChannel [true,true]; 5 enableChannel [true,true]; }; if((serverTime - _foodTimeLast) >= _foodTime) then { call _fnc_food; _foodTimeLast = serverTime; }; if((serverTime - _playerTimeLast) >= _playerTime) then { call _fnc_packCheck; zero_var_onlineTime = zero_var_onlineTime + 10;
zero_var_totalonlineTime = zero_var_totalonlineTime + 10; [6] call zero_fnc_updatePartial; if((zero_var_onlineTime < 900) && !(player getVariable["zero_var_noob",false])) then { player setVariable["zero_var_noob",true,true]; } else { if((zero_var_onlineTime >= 900) && (player getVariable["zero_var_noob",false])) then { player setVariable["zero_var_noob",nil,true]; }; }; if(zero_gang_flag getVariable["zero_var_gangControl","-1"] isEqualTo (((group player) getVariable["zero_var_gang",["0"]]) select 0) && {!(player getVariable["zero_var_restrained",false])} && ((isNull (zero_gang_flag getVariable ["zero_var_gangControlGroup",grpNull])) || ((group player) != (zero_gang_flag getVariable ["zero_var_gangControlGroup",grpNull])))) then { zero_gang_flag setVariable["zero_var_gangControlGroup",(group player), true]; }; _playerTimeLast = serverTime; }; if((serverTime - _moneyCheckLast) >= _moneyCheck) then { _curCash call _fnc_checkMoney; _moneyCheckLast = serverTime; _curCash = ([3, 0] call zero_fnc_Z0Check) + ([2, 0] call zero_fnc_Z0Check); }; if(backpack player isEqualTo "") then { zero_var_maxWeight = 74; _backpack = backpack player; } else { if(backpack player != _backpack) then { zero_var_maxWeight = 74 + (round((getNumber(configFile >> "CfgVehicles" >> (backpack player) >> "maximumload")) / 8)); if (!(player getVariable["zero_var_streife",""] in ["ZIV1","ZIV2"]) && ((playerSide isEqualTo west) || (playerSide isEqualTo independent))) then { (unitBackpack player) setObjectTextureGlobal [0,""]; }; _backpack = backpack player; }; }; if(_damage != (damage player)) then {call zero_fnc_hudUpdate; _damage = (damage player);}; if(zero_var_carryWeight > zero_var_maxWeight) then { player forceWalk true; player setFatigue 1; [localize "STR_NOTF_MaxWeight",0,"Hinweis"] call zero_fnc_msg; } else { if(isNil "zero_var_staminaMaxWalk" && isNil "zero_var_overeaten") then { player forceWalk false; player enableFatigue false; player enableStamina false; player setFatigue 0; }; }; if(cameraView == "GROUP" && alive player) then {(vehicle player) switchCamera "EXTERNAL";}; if(rating player < 0) then {player addRating 9999999999999999;}; if(serverTime > 13800 && !zero_var_session_time && !_forceSynced) then {_forceSynced = true; [] spawn {uiSleep random(120); [] call zero_fnc_updateRequest;};}; if(((serverTime - zero_var_distanceCooldown) > 5)) then { if((((getPosATL player) distance ([3648.46,13111.3,0.00117493])) > 280)) then { if(zero_var_viewState) then { switch (true) do { case ((vehicle player) isKindOf "Man"): {setViewDistance zero_var_oldViewDistance_foot; zero_var_viewDistance_foot = zero_var_oldViewDistance_foot; zero_var_viewDistance_car = zero_var_oldViewDistance_car;}; case ((vehicle player) isKindOf "LandVehicle"): {setViewDistance zero_var_oldViewDistance_car; zero_var_viewDistance_car = zero_var_oldViewDistance_car; zero_var_viewDistance_foot = zero_var_oldViewDistance_foot;}; case ((vehicle player) isKindOf "Air"): {setViewDistance zero_var_viewDistance_air}; default {setViewDistance zero_var_viewDistance_foot}; }; switch(true) do { case (viewDistance <= 1000): {setObjectViewDistance [800 ,50];}; case ((viewDistance > 1000) && (viewDistance <= 1100)): {setObjectViewDistance [880 ,50];}; case ((viewDistance > 1100) && (viewDistance <= 1200)): {setObjectViewDistance [925 ,50];}; case ((viewDistance > 1200) && (viewDistance <= 1300)): {setObjectViewDistance [970 ,50];}; case ((viewDistance > 1300) && (viewDistance <= 1400)): {setObjectViewDistance [1015 ,50];}; case ((viewDistance > 1400) && (viewDistance <= 1500)): {setObjectViewDistance [1060 ,50];}; case ((viewDistance > 1500) && (viewDistance <= 1600)): {setObjectViewDistance [1105 ,50];}; case ((viewDistance > 1600) && (viewDistance <= 1700)): {setObjectViewDistance [1151 ,50];}; case ((viewDistance > 1700) && (viewDistance <= 1800)): {setObjectViewDistance [1196 ,50];}; case ((viewDistance > 1800) && (viewDistance <= 1900)): {setObjectViewDistance [1241 ,50];}; case ((viewDistance > 1900) && (viewDistance <= 2000)): {setObjectViewDistance [1286 ,50];}; case ((viewDistance > 2000) && (viewDistance <= 2100)): {setObjectViewDistance [1331 ,50];}; case ((viewDistance > 2100) && (viewDistance <= 2200)): {setObjectViewDistance [1376 ,50];}; case ((viewDistance > 2200) && (viewDistance <= 2300)): {setObjectViewDistance [1421 ,50];}; case ((viewDistance > 2300) && (viewDistance <= 2400)): {setObjectViewDistance [1466 ,50];}; case ((viewDistance > 2400) && (viewDistance <= 2500)): {setObjectViewDistance [1511 ,50];}; case ((viewDistance > 2500) && (viewDistance <= 2600)): {setObjectViewDistance [1556 ,50];}; case ((viewDistance > 2600) && (viewDistance <= 2700)): {setObjectViewDistance [1601 ,50];}; case ((viewDistance > 2700) && (viewDistance <= 2800)): {setObjectViewDistance [1646 ,50];}; case ((viewDistance > 2800) && (viewDistance <= 2900)): {setObjectViewDistance [1691 ,50];}; case ((viewDistance > 2900) && (viewDistance <= 3000)): {setObjectViewDistance [1736 ,50];}; case ((viewDistance > 3000) && (viewDistance <= 3200)): {setObjectViewDistance [1826 ,50];}; case ((viewDistance > 3200) && (viewDistance <= 3400)): {setObjectViewDistance [1916 ,50];}; case ((viewDistance > 3400) && (viewDistance <= 3600)): {setObjectViewDistance [2007 ,50];}; case ((viewDistance > 3600) && (viewDistance <= 3800)): {setObjectViewDistance [2097 ,50];}; case ((viewDistance > 3800) && (viewDistance <= 4000)): {setObjectViewDistance [2187 ,50];}; case ((viewDistance > 4000) && (viewDistance <= 4200)): {setObjectViewDistance [2277 ,50];}; case ((viewDistance > 4200) && (viewDistance <= 4400)): {setObjectViewDistance [2367 ,50];}; case ((viewDistance > 4400) && (viewDistance <= 4600)): {setObjectViewDistance [2457 ,50];}; case ((viewDistance > 4600) && (viewDistance <= 4800)): {setObjectViewDistance [2547 ,50];}; case ((viewDistance > 4800) && (viewDistance <= 5000)): {setObjectViewDistance [2637 ,50];}; case ((viewDistance > 5000) && (viewDistance <= 5400)): {setObjectViewDistance [2818 ,50];}; case ((viewDistance > 5400) && (viewDistance <= 5800)): {setObjectViewDistance [2998 ,50];}; case ((viewDistance > 5800) && (viewDistance <= 6200)): {setObjectViewDistance [3178 ,50];}; case ((viewDistance > 6200) && (viewDistance <= 6600)): {setObjectViewDistance [3358 ,50];}; case ((viewDistance > 6600) && (viewDistance <= 7000)): {setObjectViewDistance [3538 ,50];}; case ((viewDistance > 7000) && (viewDistance <= 7400)): {setObjectViewDistance [3719 ,50];}; case ((viewDistance > 7400) && (viewDistance <= 7800)): {setObjectViewDistance [3899 ,50];}; case ((viewDistance > 7800) && (viewDistance <= 8200)): {setObjectViewDistance [4079 ,50];}; case ((viewDistance > 8200) && (viewDistance <= 8600)): {setObjectViewDistance [4259 ,50];}; case ((viewDistance > 8600) && (viewDistance <= 9000)): {setObjectViewDistance [4440 ,50];}; case ((viewDistance > 9000) && (viewDistance <= 10000)): {setObjectViewDistance [4890 ,50];}; case ((viewDistance > 10000) && (viewDistance <= 11000)): {setObjectViewDistance [5341 ,50];}; case ((viewDistance > 11000) && (viewDistance <= 12000)): {setObjectViewDistance [5791 ,50];}; case (viewDistance > 12000): {setObjectViewDistance [5791 ,50];}; default{setObjectViewDistance [800 ,50];}; }; zero_var_viewState = false; }; } else { if(!zero_var_viewState) then { zero_var_oldViewDistance_foot = zero_var_viewDistance_foot; zero_var_oldViewDistance_car = zero_var_viewDistance_car; zero_var_viewDistance_foot = 300; zero_var_viewDistance_car = 300; setViewDistance 300; zero_var_viewState = true; }; }; zero_var_distanceCooldown = serverTime; }; if((serverTime - _isWaterLast) >= _isWater) then { _isWaterLast = serverTime; if(surfaceIsWater (position player) && !((environmentEnabled) select 0)) then { enableEnvironment true; }; if(!surfaceIsWater (position player) && ((environmentEnabled) select 0)) then { enableEnvironment [false, true]; }; }; if ((zero_var_holstered) && (currentWeapon player != "")) then { zero_var_holstered = false; }; if((serverTime - _fCheckLast) >= _fCheck) then { _fCheckLast = serverTime; { [_x] call zero_fnc_addExplosionEventhandler; } forEach (entities [["CAManBase","Car","Air","Ship"], [], true, false]); zero_var_explosionCounter = 0; }; uiSleep 1; };
