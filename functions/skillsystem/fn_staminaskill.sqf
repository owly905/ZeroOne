if (!hasInterface) exitWith {}; private["_walkDis","_speed","_maxWalk"]; _walkDis = 0; _speed = 0; _maxWalk = ["stamina"] call zero_fnc_getSkillValueCharacter; while{true} do { uiSleep 0.5; if(!alive player || zero_var_killed || zero_var_aborted) then { _walkDis = 0; player setFatigue 0; player enableFatigue false; player enableStamina false; }else{ _speed = speed player; if((_speed > 10 || _speed < (-10)) && (isNull (objectParent player)) && !(player getVariable["zero_var_escorting",false])) then { _walkDis = _walkDis + 1; if(_speed > 15) then {_walkDis = _walkDis + 0.5;}; if(_walkDis >= _maxWalk) then { _walkDis = 0; zero_var_thirst = zero_var_thirst - 2; zero_var_hunger = zero_var_hunger - 2; [] call zero_fnc_hudUpdate; if(!isNil "zero_var_redgull_used") exitWith {}; ["stamina"] call zero_fnc_improveSkillCharacter; _maxWalk = ["stamina"] call zero_fnc_getSkillValueCharacter;
zero_var_staminaMaxWalk = true; player enableFatigue true; player setFatigue 1; for "_i" from 0 to 60 step 1 do { uiSleep 1; if (!isNil "zero_var_stamina" || !isNil "zero_var_redgull_used") exitWith {player setFatigue 0;player enableFatigue false;}; if (getFatigue player != 1) then {player setFatigue 1;}; if (!alive player) exitWith {player setFatigue 0;player enableFatigue false;}; }; player setFatigue 0; player enableFatigue false; player enableStamina false; zero_var_stamina = nil; zero_var_staminaMaxWalk = nil; uiSleep 1; player setFatigue 0; player enableFatigue false; player enableStamina false; }; }; if((_speed < 10 && _speed > (-10)) || (!isNull (objectParent player))) then { _walkDis = _walkDis - 0.5; if(_walkDis < 0 || zero_var_buff_stamina) then {_walkDis = 0;}; }; [_walkDis,_maxWalk] call zero_fnc_staminaBarUpdate; }; };
