if (!hasInterface) exitWith {}; private ["_display","_primaryWeaponList","_secondaryWeaponList","_handgunWeaponList","_magazineList","_entity","_magazinePlayer","_loadOut","_primaryWeaponInfo","_secondaryWeaponInfo","_handgunWeaponInfo","_uniformInfo","_vestInfo","_backpackInfo","_magazines","_uniformItems","_vestItems","_backpackItems","_count","_index"]; disableSerialization; _display = findDisplay 1000; _primaryWeaponList = _display displayCtrl 1600; _secondaryWeaponList = _display displayCtrl 1606; _handgunWeaponList = _display displayCtrl 1612; _magazineList = _display displayCtrl 1618; _magazinePlayer = _display displayCtrl 1619; _loadOut = getUnitLoadout player; _primaryWeaponInfo = _loadOut select 0; _secondaryWeaponInfo = _loadOut select 1; _handgunWeaponInfo = _loadOut select 2; _uniformInfo = _loadOut select 3; _vestInfo = _loadOut select 4; _backpackInfo = _loadOut select 5; _magazines = []; _uniformItems = if (!(_uniformInfo isEqualTo []) && {!((_uniformInfo select 1)isEqualTo [])}) then {(_uniformInfo select 1)} else { []}; _vestItems = if (!(_vestInfo isEqualTo []) && {!((_vestInfo select 1)isEqualTo [])}) then {(_vestInfo select 1)} else { []}; _backpackItems = if (!(_backpackInfo isEqualTo []) && {!((_backpackInfo select 1)isEqualTo [])}) then {(_backpackInfo select 1)} else { []}; { _entity = if(typeName (_x select 0) == "ARRAY") then {toLower((_x select 0) select 0)}else{toLower(_x select 0)}; if (isClass(configFile >> "CfgMagazines" >> _entity)) then { _count = if (count _x > 2) then {_x select 1} else {1}; _index = [toLower(_entity), _magazines] call zero_fnc_findIndex; if (_index isEqualTo -1) then { _magazines pushBack [toLower(_entity), _count]; } else { _magazines set [_index, [toLower(_entity), ((_magazines select _index) select 1) + _count]]; }; }; } forEach _uniformItems + _vestItems + _backpackItems; lbClear _primaryWeaponList; lbClear _secondaryWeaponList; lbClear _handgunWeaponList; lbClear _magazineList; lbClear _magazinePlayer; { _entity = _x select 0; if(isClass(configFile >> "CfgMagazines" >> _entity)) then { _magazinePlayer lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _entity >> "displayName")]; _magazinePlayer lbSetTooltip [lbSize(_magazinePlayer) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _entity >> "displayName")]]; _magazinePlayer lbSetPicture [lbSize(_magazinePlayer) - 1, getText (configFile >> "CfgMagazines" >> _entity >> "picture")]; _magazinePlayer lbSetValue [lbSize(_magazinePlayer) - 1, (_x select 1)]; _magazinePlayer lbSetData [lbSize(_magazinePlayer) - 1, _entity]; }; } forEach _magazines; _display setVariable["zero_var_playerMagazines",_magazines]; { { _entity = toLower(_x select 0); if (_entity != "") then { if (isClass (configFile >> "CfgWeapons" >> _entity)) then { if(getNumber(configFile >> "CfgWeapons" >> _entity >> "type") == 1) then { _primaryWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _primaryWeaponList lbSetTooltip [lbSize(_primaryWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _primaryWeaponList lbSetPicture [lbSize(_primaryWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")]; _primaryWeaponList lbSetValue [lbSize(_primaryWeaponList) - 1, (_x select 1)]; _primaryWeaponList lbSetData [lbSize(_primaryWeaponList) - 1, _entity]; }else{ if(getNumber(configFile >> "CfgWeapons" >> _entity >> "type") == 2) then { _handgunWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _handgunWeaponList lbSetTooltip [lbSize(_handgunWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _handgunWeaponList lbSetPicture [lbSize(_handgunWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")];
_handgunWeaponList lbSetValue [lbSize(_handgunWeaponList) - 1, (_x select 1)]; _handgunWeaponList lbSetData [lbSize(_handgunWeaponList) - 1, _entity]; }else{ if(getNumber(configFile >> "CfgWeapons" >> _entity >> "type") == 4) then { _secondaryWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _secondaryWeaponList lbSetTooltip [lbSize(_secondaryWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _secondaryWeaponList lbSetPicture [lbSize(_secondaryWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")]; _secondaryWeaponList lbSetValue [lbSize(_secondaryWeaponList) - 1, (_x select 1)]; _secondaryWeaponList lbSetData [lbSize(_secondaryWeaponList) - 1, _entity]; }else{ if((getNumber(configFile >> "CfgWeapons" >> _entity >> "ItemInfo" >> "type")) in [101,201,301]) then { _primaryWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _primaryWeaponList lbSetTooltip [lbSize(_primaryWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _primaryWeaponList lbSetPicture [lbSize(_primaryWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")]; _primaryWeaponList lbSetValue [lbSize(_primaryWeaponList) - 1, (_x select 1)]; _primaryWeaponList lbSetData [lbSize(_primaryWeaponList) - 1, _entity]; _handgunWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _handgunWeaponList lbSetTooltip [lbSize(_handgunWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _handgunWeaponList lbSetPicture [lbSize(_handgunWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")]; _handgunWeaponList lbSetValue [lbSize(_handgunWeaponList) - 1, (_x select 1)]; _handgunWeaponList lbSetData [lbSize(_handgunWeaponList) - 1, _entity]; }; if((getNumber(configFile >> "CfgWeapons" >> _entity >> "ItemInfo" >> "type")) == 302) then { _primaryWeaponList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]; _primaryWeaponList lbSetTooltip [lbSize(_primaryWeaponList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgWeapons" >> _entity >> "displayName")]]; _primaryWeaponList lbSetPicture [lbSize(_primaryWeaponList) - 1, getText (configFile >> "CfgWeapons" >> _entity >> "picture")]; _primaryWeaponList lbSetValue [lbSize(_primaryWeaponList) - 1, (_x select 1)]; _primaryWeaponList lbSetData [lbSize(_primaryWeaponList) - 1, _entity]; }; }; }; }; }else{ if(isClass(configFile >> "CfgMagazines" >> _entity)) then { _magazineList lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _entity >> "displayName")]; _magazineList lbSetTooltip [lbSize(_magazineList) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _entity >> "displayName")]]; _magazineList lbSetPicture [lbSize(_magazineList) - 1, getText (configFile >> "CfgMagazines" >> _entity >> "picture")]; _magazineList lbSetValue [lbSize(_magazineList) - 1, (_x select 1)]; _magazineList lbSetData [lbSize(_magazineList) - 1, _entity]; }; }; }; } forEach _x; } forEach zero_var_locker; if((lbSize(_primaryWeaponList) - 1) isEqualTo -1) then {_primaryWeaponList lbAdd "Keine Primärwaffen verfügbar";}; if((lbSize(_secondaryWeaponList) - 1) isEqualTo -1) then {_secondaryWeaponList lbAdd "Keine Sekundärwaffen verfügbar";}; if((lbSize(_handgunWeaponList) - 1) isEqualTo -1) then {_handgunWeaponList lbAdd "Keine Pistolen verfügbar";}; if((lbSize(_magazineList) - 1) isEqualTo -1) then {_magazineList lbAdd "Keine Magazine verfügbar";}; if((lbSize(_magazinePlayer) - 1) isEqualTo -1) then {_magazinePlayer lbAdd "Keine Magazine verfügbar";}; _primaryWeaponList lbSetCurSel -1; _secondaryWeaponList lbSetCurSel -1; _handgunWeaponList lbSetCurSel -1; _magazineList lbSetCurSel -1; _magazinePlayer lbSetCurSel -1; lbSort _primaryWeaponList; lbSort _secondaryWeaponList; lbSort _handgunWeaponList; lbSort _magazineList; lbSort _magazinePlayer;
