if (!hasInterface) exitWith {}; private ["_display","_curTarget","_Btn1","_Btn2","_Btn3","_Btn4","_Btn5","_Btn6","_Btn7","_Btn8","_Btn9","_isVehicle"]; if(!dialog) then { createDialog "zero_var_vInteraction_Menu"; }; disableSerialization; _curTarget = param[0,objNull,[objNull]]; if(isNull _curTarget) exitWith {closeDialog 0;}; _isVehicle = if((_curTarget isKindOf "landVehicle") || (_curTarget isKindOf "Ship") || (_curTarget isKindOf "Air")) then {true} else {false}; if(!_isVehicle) exitWith {closeDialog 0;}; _display = findDisplay 37400; _Btn1 = _display displayCtrl 37450; _Btn2 = _display displayCtrl 37451; _Btn3 = _display displayCtrl 37452; _Btn4 = _display displayCtrl 37453; _Btn5 = _display displayCtrl 37454; _Btn6 = _display displayCtrl 37455; _Btn7 = _display displayCtrl 37456; _Btn8 = _display displayCtrl 37457; _Btn9 = _display displayCtrl 37458; zero_var_pInact_curTarget = _curTarget; [_curTarget] spawn { disableSerialization; if !(params [["_vehicle", objNull, [objNull]]]) exitWith {}; private _distance = ((boundingBox _vehicle select 1) select 0) + 5; waitUntil {sleep 0.5; _vehicle distance player > _distance || {isNull (findDisplay 37400)}}; if !(isNull (findDisplay 37400)) then { closeDialog 0; closeDialog 0; }; }; _Btn1 ctrlSetText localize "STR_vInAct_Repair"; _Btn1 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_repairTruck;closeDialog 0;"; if("ToolKit" in (items player) && (getDammage _curTarget < 1)) then {_Btn1 ctrlEnable true;} else {_Btn1 ctrlEnable false;}; if(playerSide isEqualTo west) exitWith { _Btn2 ctrlSetText localize "STR_vInAct_SearchVehicle"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_vehInvSearch;closeDialog 0;"; _Btn3 ctrlSetText localize "STR_vInAct_PullOut"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {(localize 'STR_NOTF_PullOut_Update') call zero_fnc_msg;};  zero_var_allowedToRefresh = serverTime; [zero_var_pInact_curTarget] spawn zero_fnc_pulloutAction;closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo []) then {_Btn3 ctrlEnable false;}; _Btn4 ctrlSetText localize "STR_vInAct_Impound"; _Btn4 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_impoundAction;closeDialog 0;"; _Btn5 ctrlSetText localize "STR_vInAct_Unflip"; _Btn5 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [[player, 'zero_var_fnc_setPos', [zero_var_pInact_curTarget, [getPos zero_var_pInact_curTarget select 0, getPos zero_var_pInact_curTarget select 1, (getPos zero_var_pInact_curTarget select 2)+((boundingBox zero_var_pInact_curTarget select 1) select 2)]]], 'zero_fnc_remoteExecuteCommand', zero_var_HC1_owner] call zero_fnc_sendPacket; closeDialog 0; zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && {!canMove _curTarget}) then { _Btn5 ctrlEnable true;} else {_Btn5 ctrlEnable false;}; _Btn6 ctrlSetText localize "STR_vInAct_PushBoat"; _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [player, zero_var_pInact_curTarget] call zero_fnc_pushBoat; closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && _curTarget isKindOf "Ship") then { _Btn6 ctrlEnable true;} else {_Btn6 ctrlEnable false}; _Btn7 ctrlSetText localize "STR_vInAct_GetInKart"; _Btn7 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; if (locked zero_var_pInact_curTarget isEqualTo 0) then {zero_var_pInact_curTarget removeAllEventHandlers 'Engine';zero_var_pInact_curTarget addEventHandler['Engine',{_this call zero_fnc_engineHandler;}];player moveInDriver zero_var_pInact_curTarget;}; closeDialog 0;zero_var_action_inUse = false;"; if((isNull (driver _curTarget)) && {canMove _curTarget} && {locked _curTarget isEqualTo 0}) then {_Btn7 ctrlEnable true;} else {_Btn7 ctrlEnable false}; _Btn8 ctrlSetText localize "STR_vInAct_DestroyVehicle"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_destroyVehicleMenu; zero_var_action_inUse = false;"; if(typeOf (_curTarget) == "B_Truck_01_Repair_F") then {_Btn8 ctrlEnable true;}else{_Btn8 ctrlEnable false;}; }; if(playerSide isEqualTo civilian || playerSide isEqualTo east) exitWith { _Btn2 ctrlSetText localize "STR_vInAct_Unflip"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [[player, 'zero_var_fnc_setPos', [zero_var_pInact_curTarget, [getPos zero_var_pInact_curTarget select 0, getPos zero_var_pInact_curTarget select 1, (getPos zero_var_pInact_curTarget select 2)+((boundingBox zero_var_pInact_curTarget select 1) select 2)]]], 'zero_fnc_remoteExecuteCommand', zero_var_HC1_owner] call zero_fnc_sendPacket; closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && {!canMove _curTarget}) then { _Btn2 ctrlEnable true;
} else {_Btn2 ctrlEnable false;}; _Btn3 ctrlSetText localize "STR_vInAct_PushBoat"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [player, zero_var_pInact_curTarget] call zero_fnc_pushBoat; closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && _curTarget isKindOf "Ship") then { _Btn3 ctrlEnable true;} else {_Btn3 ctrlEnable false}; _Btn4 ctrlSetText localize "STR_vInAct_PullOut"; _Btn4 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {(localize 'STR_NOTF_PullOut_Update') call zero_fnc_msg;};  zero_var_allowedToRefresh = serverTime; [zero_var_pInact_curTarget] spawn zero_fnc_pulloutAction;closeDialog 0;zero_var_action_inUse = false;"; if(((crew _curTarget) isEqualTo []) || (locked _curTarget in [2,3])) then {_Btn4 ctrlEnable false;}; _Btn5 ctrlSetText localize "STR_vInAct_GetInKart"; _Btn5 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;if (locked zero_var_pInact_curTarget isEqualTo 0) then {zero_var_pInact_curTarget removeAllEventHandlers 'Engine';zero_var_pInact_curTarget addEventHandler['Engine',{_this call zero_fnc_engineHandler;}];player moveInDriver zero_var_pInact_curTarget;}; closeDialog 0;zero_var_action_inUse = false;"; if((isNull (driver _curTarget)) && {canMove _curTarget} && {locked _curTarget isEqualTo 0}) then {_Btn5 ctrlEnable true;} else {_Btn5 ctrlEnable false}; _Btn6 ctrlSetText localize "STR_vInAct_DeviceMine"; _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_deviceMine;closeDialog 0;zero_var_action_inUse = false;"; if(typeOf _curTarget == "O_Truck_03_device_F" && isNil {(_curTarget getVariable "mining")} && local _curTarget && {_curTarget in zero_var_vehicles}) then {_Btn6 ctrlEnable true;} else {_Btn6 ctrlEnable false;}; _Btn7 ctrlSetText "Fahrzeugschein"; _Btn7 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 1}) exitWith {};  zero_var_allowedToRefresh = serverTime; [format['%1', (zero_var_pInact_curTarget getVariable['zero_var_vehicle_real_owner',['','Unbekannt']]) select 1],1,'Fahrzeugschein'] call zero_fnc_msg"; if(_curTarget in zero_var_vehicles) then {_Btn7 ctrlEnable true} else {_Btn7 ctrlEnable false}; _Btn8 ctrlShow false; _Btn9 ctrlShow false; }; if(playerSide isEqualTo independent) exitWith { _Btn2 ctrlSetText localize "STR_vInAct_Unflip"; _Btn2 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [[player, 'zero_var_fnc_setPos', [zero_var_pInact_curTarget, [getPos zero_var_pInact_curTarget select 0, getPos zero_var_pInact_curTarget select 1, (getPos zero_var_pInact_curTarget select 2)+((boundingBox zero_var_pInact_curTarget select 1) select 2)]]], 'zero_fnc_remoteExecuteCommand', zero_var_HC1_owner] call zero_fnc_sendPacket; closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && {!canMove _curTarget}) then { _Btn2 ctrlEnable true;} else {_Btn2 ctrlEnable false;}; _Btn3 ctrlSetText localize "STR_vInAct_PushBoat"; _Btn3 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {};  zero_var_allowedToRefresh = serverTime; [player, zero_var_pInact_curTarget] call zero_fnc_pushBoat; closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo [] && _curTarget isKindOf "Ship") then { _Btn3 ctrlEnable true;} else {_Btn3 ctrlEnable false}; _Btn4 ctrlSetText localize "STR_vInAct_PullOut"; _Btn4 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 5}) exitWith {(localize 'STR_NOTF_PullOut_Update') call zero_fnc_msg;};  zero_var_allowedToRefresh = serverTime; [zero_var_pInact_curTarget] spawn zero_fnc_pulloutAction;closeDialog 0;zero_var_action_inUse = false;"; if((crew _curTarget) isEqualTo []) then {_Btn4 ctrlEnable false;}; _Btn5 ctrlSetText localize "STR_vInAct_GetInKart"; _Btn5 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;if (locked zero_var_pInact_curTarget isEqualTo 0) then {zero_var_pInact_curTarget removeAllEventHandlers 'Engine';zero_var_pInact_curTarget addEventHandler['Engine',{_this call zero_fnc_engineHandler;}];player moveInDriver zero_var_pInact_curTarget;}; closeDialog 0;zero_var_action_inUse = false;"; if((isNull (driver _curTarget)) && {canMove _curTarget} && {locked _curTarget isEqualTo 0}) then {_Btn5 ctrlEnable true;} else {_Btn5 ctrlEnable false}; _Btn6 ctrlSetText localize "STR_vInAct_Registration"; _Btn6 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_searchVehAction;closeDialog 0;"; _Btn7 ctrlSetText localize "STR_vInAct_Impound"; _Btn7 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_impoundAction;closeDialog 0;"; _Btn8 ctrlSetText "Leiche herausziehen"; _Btn8 buttonSetAction "if(!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {};zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_pulloutDead;closeDialog 0;"; if((crew _curTarget) isEqualTo []) then {_Btn8 ctrlEnable false;}; _Btn8 ctrlShow false; _Btn9 ctrlSetText "VER-Nachricht"; _Btn9 buttonSetAction "if (!isNil 'zero_var_allowedToRefresh' && {serverTime - zero_var_allowedToRefresh < 0.1}) exitWith {}; zero_var_allowedToRefresh = serverTime;[zero_var_pInact_curTarget] spawn zero_fnc_vernachricht;closeDialog 0;"; };
