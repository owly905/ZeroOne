if (!hasInterface) exitWith {}; disableSerialization; private["_control","_className","_dataArr","_vehicleInfo","_trunkSpace","_sellPrice","_retrievePrice","_shop","_shopArr","_index","_film","_skin","_insurance","_configs"]; _control = _this select 0; _index = _this select 1; _dataArr = call compile format["%1",(_control lbData _index)]; _className = _dataArr select 0; _vehicleInfo = [_className] call zero_fnc_fetchVehInfo; _trunkSpace = getNumber(missionConfigFile >> "zero_CfgVehicles" >> _className >> "trunk"); _retrievePrice = getNumber(missionConfigFile >> "zero_CfgVehicles" >> _className >> "garage_fee"); if(zero_var_garage_mode == "Gangeroberung") then {_retrievePrice = 0;}; _sellPrice = getNumber(missionConfigFile >> "zero_CfgVehicles" >> _className >> "garage_sell"); _film = "Keine"; _skin = "Standard"; _insurance = "Keine"; if(playerSide isEqualTo independent || playerSide isEqualTo west) then { _retrievePrice = 0; _shop = format["%1_%2",if(playerSide isEqualTo west) then {"cop"}else{"feuerwehr"},toLower(zero_var_garage_type)]; _shopArr = (getArray(missionConfigFile >> "zero_VehicleShops" >> _shop >> "vehicles")); _index = [_className,_shopArr] call zero_fnc_findIndex; if(_index != -1) then { _sellPrice = round(((_shopArr select _index) select 1)/2); }else{ _sellPrice = 1000; }; }; if((_dataArr select 1) != "" && (_dataArr select 1) != "Default") then { _skin = (_dataArr select 1); }; if((_dataArr select 2) != "" && (_dataArr select 2) != "Default") then { _film = getText(missionConfigFile >> "zero_CfgMaterials" >> (_dataArr select 2) >> "name"); }; if((_dataArr select 3) != 0) then { _insurance = "Gekauft"; ctrlEnable[2804,false]; ((findDisplay 2800) displayCtrl 2804) ctrlSetTooltip "Versicherung bereits gekauft"; ctrlEnable[2805,false]; } else { ctrlEnable[2804,true]; ctrlEnable[2805,true]; ((findDisplay 2800) displayCtrl 2804) cbSetChecked false; ((findDisplay 2800) displayCtrl 2804) ctrlSetTooltip "Versicherung kaufen"; if(zero_var_playerSide in [east, civilian]) then { _configs = getArray(missionConfigFile >> "zero_VehicleShops" >> "kart_shop" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "civ_car" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "civ_truck" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "civ_air" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "civ_ship" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "reb_car" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "reb_air" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "reb_jet" >> "vehicles") + getArray(missionConfigFile >> "zero_VehicleShops" >> "gang_car" >> "vehicles");
{ if(_className == (_x select 0)) exitWith { _insurance = format["€%1", [round((_x select 1) * 1.5 * 0.7)] call zero_fnc_numberText]; }; } forEach _configs; }else{ _shop = format["%1_%2",if(playerSide isEqualTo west) then {"cop"}else{"feuerwehr"},toLower(zero_var_garage_type)]; _shopArr = (getArray(missionConfigFile >> "zero_VehicleShops" >> _shop >> "vehicles")); _index = [_className,_shopArr] call zero_fnc_findIndex; _insurance = if(_index != -1) then { format["€%1", [round(((_shopArr select _index) select 1) * 1.5 * 0.7)] call zero_fnc_numberText]; }else{ format["€%1", [1000] call zero_fnc_numberText]; }; }; }; if((_dataArr select 4) != 0) then { ctrlEnable[2804,false]; ctrlEnable[2805,false]; ctrlEnable[2806,false]; ((findDisplay 2800) displayCtrl 2806) ctrlSetTooltip "Das Fahrzeug wurde beschlagnahmt. Du kannst es am Abstellhof freikaufen."; ctrlEnable[2807,false]; ((findDisplay 2800) displayCtrl 2807) ctrlSetTooltip "Das Fahrzeug wurde beschlagnahmt. Du kannst es am Abstellhof freikaufen."; }else{ ctrlEnable[2806,true]; ((findDisplay 2800) displayCtrl 2806) ctrlSetTooltip ""; ctrlEnable[2807,true]; ((findDisplay 2800) displayCtrl 2807) ctrlSetTooltip ""; }; (((findDisplay 2800) displayCtrl 2803)) ctrlSetStructuredText parseText format[ (localize "STR_Shop_Veh_UI_RetrievalP")+ " <t color='#8cff9b'>€%1</t><br/>" + (localize "STR_Shop_Veh_UI_SellP")+ " <t color='#8cff9b'>€%2</t><br/>" + (localize "STR_Shop_Veh_UI_Color")+ " %8<br/>" + "Folie:" + " %9<br/>" + "Versicherung:" + " <t color='#8cff9b'>%10</t><br/>" + (localize "STR_Shop_Veh_UI_MaxSpeed")+ " %3 km/h<br/>" + (localize "STR_Shop_Veh_UI_HPower")+ " %4<br/>" + (localize "STR_Shop_Veh_UI_PSeats")+ " %5<br/>" + (localize "STR_Shop_Veh_UI_Trunk")+ " %6<br/>" + (localize "STR_Shop_Veh_UI_Fuel")+ " %7", [_retrievePrice] call zero_fnc_numberText, [_sellPrice] call zero_fnc_numberText, _vehicleInfo select 8, _vehicleInfo select 11, _vehicleInfo select 10, if(_trunkSpace == -1) then {"None"} else {_trunkSpace}, _vehicleInfo select 12, _skin, _film, _insurance ]; ctrlShow [2803,true]; ctrlShow [2830,true];
