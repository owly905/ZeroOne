if (!hasInterface) exitWith {}; private["_display","_item_list","_gear_list","_shop_data","_name","_price","_gang","_index"]; disableSerialization; private _isGangDealer = param [0,false,[false]]; _display = findDisplay 2400; _item_list = _display displayCtrl 2401; _gear_list = _display displayCtrl 2402; if (_isGangDealer) then { _display setVariable ["zero_var_display_specialdealer",true]; } else { _isGangDealer = _display getVariable ["zero_var_display_specialdealer",false]; }; _gang = (group player) getVariable ["zero_var_gang",[]]; if(_gang isEqualTo [] || {(typeName (_gang select(count _gang -1)) == "BOOL")}) then { ctrlEnable[2406,false]; }else{ _index = [getPlayerUID player, _gang select 3] call zero_fnc_findIndex; if(_index isEqualTo -1) then { ctrlEnable[2406,false]; }else{ if((((_gang select 3) select _index) select 1) < 2) then { ctrlEnable[2406,false]; }; }; }; lbClear _item_list; lbClear _gear_list; _shop_data = if(zero_var_shop_type == "furniture") then { private _configs = "((configName _x) find 'frn_') != -1" configClasses (missionConfigFile >> "zero_CfgItems"); private _result = []; { _result pushBack (configName _x); } forEach _configs; ["Möbelhaus",_result]; } else { private _config = (missionConfigFile >> "zero_CfgItemShopsVirtual" >> zero_var_shop_type); [getText(_config >> "name"), getArray(_config >> "items")]; }; ctrlSetText[2403,format["%1", _shop_data select 0]];
{ _index = -1; if(!isNil "zero_var_market_prices" && _x in ["apple","peach","wine","bananen"]) then { _index = [_x,zero_var_market_prices] call zero_fnc_findIndex; }else{ _index = getNumber(missionConfigFile >> "zero_CfgItems" >> _x >> "buyPrice"); }; if(zero_var_shop_type == "danger") then {_index = -1;}; if(_index != -1) then { if(!isNil "zero_var_market_prices" && _x in ["apple","peach","wine","bananen"]) then { _price = round(((zero_var_market_prices select _index) select 1) * 2); }else{ _price = _index; }; if (_isGangDealer) then { _price = _price * 1.2; }; if(((playerSide isEqualTo west) || (playerSide isEqualTo independent)) && (_x in ["redgull","lockpick","fuelF"])) then {_price = 2000;}; if((playerSide isEqualTo east) && (_x in ["defibrillator","adrenalin"])) then {_price = _price * 2;}; _name = getText(missionConfigFile >> "zero_CfgItems" >> _x >> "name"); _item_list lbAdd format["%1  (€%2)",_name,[_price] call zero_fnc_numberText]; _item_list lbSetData [(lbSize _item_list)-1,_x]; _item_list lbSetValue [(lbSize _item_list)-1,_price]; }; } forEach (_shop_data select 1); { _index = [_x, zero_var_inventory] call zero_fnc_findIndex; if(_index != -1) then { private _val = (zero_var_inventory select _index) select 1; _name = getText(missionConfigFile >> "zero_CfgItems" >> _x >> "name"); if(_val > 0) then { _gear_list lbAdd format["%1x %2",_val,_name]; _gear_list lbSetData [(lbSize _gear_list)-1,_x]; }; }; } forEach (_shop_data select 1);
