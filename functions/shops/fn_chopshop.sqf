if (!hasInterface) exitWith {}; disableSerialization; private["_exit","_pos","_ui","_progress","_pgText","_nearVehicles","_cP","_control","_price","_vehicle","_text","_bool"]; _control = ((findDisplay 39400) displayCtrl 39402); if((lbCurSel _control) == -1) exitWith {"Du hast nichts ausgewählt!" call zero_fnc_msg;}; _price = _control lbValue (lbCurSel _control); _vehicle = _control lbData (lbCurSel _control); _text = _control lbText(lbCurSel _control); _vehicle = call compile format["%1", _vehicle]; _nearVehicles = nearestObjects [zero_var_chopShop,["Car","Truck","Air"],25]; _vehicle = _nearVehicles select _vehicle; _bool = false; if(isNil {_vehicle}) exitWith {}; if (((zero_var_reallifetime + serverTime) / 3600) > 12) then { if (playerSide != west) then { if((zero_gang_flag getVariable["zero_var_gangControl","-1"]) != (((group player) getVariable["zero_var_gang",["-1"]]) select 0)) exitWith {_bool = true}; if((group player) getVariable["zero_var_gang",[]] isEqualTo []) exitWith {_bool = true}; }; }; if (_bool) exitWith {"Deine Gang muss im Besitz der Gang-Eroberung sein um Fahrzeuge zu verkaufen!" call zero_fnc_msg;}; if(!(_vehicle in zero_var_vehicles) && playerSide != west) exitWith {"Du brauchst den Schlüssel um das Fahrzeug zu verkaufen!" call zero_fnc_msg;}; if(!((crew _vehicle) isEqualTo [])) exitWith {"Das Fahrzeug muss leer sein." call zero_fnc_msg;}; _exit = false; _pos = (position player); closeDialog 0; if(player getVariable["zero_var_restrained",false]) exitWith {}; 5 cutRsc ["zero_var_progress","PLAIN"]; _ui = uiNamespace getVariable "zero_var_progress"; _progress = _ui displayCtrl 38201;
_pgText = _ui displayCtrl 38202; _pgText ctrlSetText format["Bleibe in einem Radius von 10m (1%1)...","%"]; _progress progressSetPosition 0.01; _cP = 0.01; if (playerSide isEqualTo WEST) then { while{true} do { uiSleep 3; _cP = _cP + 0.01; _progress progressSetPosition _cP; _pgText ctrlSetText format["Bleibe in einem Radius von 10m (%1%2)...",round(_cP * 100),"%"]; if(_cP >= 1) exitWith {5 cutText ["","PLAIN"];}; if(!((crew _vehicle) isEqualTo [])) exitWith {"Das Fahrzeug muss leer sein." call zero_fnc_msg; _exit = true;}; if(player distance _pos > 10.5) exitWith {5 cutText ["","PLAIN"]; _exit = true; "Du bist zu weit weg gelaufen. !" call zero_fnc_msg;}; if!(alive player) exitWith {5 cutText ["","PLAIN"]; _exit = true;}; if(player getVariable["zero_var_restrained",false]) exitWith {5 cutText ["","PLAIN"]; _exit = true;}; }; } else { while{true} do { uiSleep 6; _cP = _cP + 0.01; _progress progressSetPosition _cP; _pgText ctrlSetText format["Bleibe in einem Radius von 10m (%1%2)...",round(_cP * 100),"%"]; if(_cP >= 1) exitWith {5 cutText ["","PLAIN"];}; if(!((crew _vehicle) isEqualTo [])) exitWith {"Das Fahrzeug muss leer sein." call zero_fnc_msg; _exit = true;}; if(player distance _pos > 10.5) exitWith {5 cutText ["","PLAIN"]; _exit = true; "Du bist zu weit weg gelaufen. !" call zero_fnc_msg;}; if!(alive player) exitWith {5 cutText ["","PLAIN"]; _exit = true;}; if(player getVariable["zero_var_restrained",false]) exitWith {5 cutText ["","PLAIN"]; _exit = true;}; }; }; if(!_exit) then { if(playerSide isEqualTo west) then { [[player, "zero_var_fnc_setDamage", [_vehicle, 1.914672]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; } else { [_vehicle,_text,_price] call zero_fnc_chopShopSell; }; };
