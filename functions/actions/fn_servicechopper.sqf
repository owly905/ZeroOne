if (!hasInterface) exitWith {}; private["_search","_ui","_progress","_cP","_pgText","_title","_veh"]; if(zero_var_action_inUse) exitWith {(localize "STR_NOTF_Action") call zero_fnc_msg;}; _search = nearestObjects[getMarkerPos "air_serv_1", ["Air"],10]; if(_search isEqualTo []) exitWith {(localize "STR_Service_Chopper_NoAir") call zero_fnc_msg;}; _veh = _search select 0; if(([3, 0] call zero_fnc_Z0Check) < 1000) exitWith { (localize "STR_Serive_Chopper_NotEnough") call zero_fnc_msg;}; [1, ([3, 0] call zero_fnc_Z0Check) - 1000] call zero_fnc_Z0Check; disableSerialization; zero_var_action_inUse = true; _title = localize "STR_Service_Chopper_Servicing"; 5 cutRsc ["zero_var_progress","PLAIN"]; _ui = uiNamespace getVariable "zero_var_progress"; _progress = _ui displayCtrl 38201; _pgText = _ui displayCtrl 38202; _pgText ctrlSetText format["%2 (1%1)...","%",_title];
_progress progressSetPosition 0.01; _cP = 0.01; while {true} do { uiSleep 0.2; _cP = _cP + 0.01; _progress progressSetPosition _cP; _pgText ctrlSetText format["%3 (%1%2)...",round(_cP * 100),"%",_title]; if(_cP >= 1 || !alive _veh || _veh distance (getMarkerPos "air_serv_1") > 10) exitWith {}; }; zero_var_action_inUse = false; if(!alive _veh || _veh distance (getMarkerPos "air_serv_1") > 10) exitWith {zero_var_action_inUse = false; (localize "STR_Service_Chopper_Missing") call zero_fnc_msg;}; if(!local _veh) then { [[_veh,1],"zero_fnc_setFuel",_veh] call zero_fnc_sendPacket; }else{ _veh setFuel 1; }; [[player, "zero_var_fnc_setDamage", [_veh, 0]], "zero_fnc_remoteExecuteCommand", zero_var_HC1_owner] call zero_fnc_sendPacket; 5 cutText ["","PLAIN"]; titleText [localize "STR_Service_Chopper_Done","PLAIN"]; zero_var_action_inUse = false;
