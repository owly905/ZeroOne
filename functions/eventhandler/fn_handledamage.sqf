if (!hasInterface) exitWith {}; if((call(zero_var_adminLevel) > 0)) then { diag_log format["zero_fnc_handleDamage %1", _this]; }; params [ ["_unit", objNull, [objNull]], ["_selectionName", "", [""]], ["_damage", 0, [0]], ["_source", objNull, [objNull]], ["_projectile", "", [""]], ["_hitPartIndex", -1, [-1]], ["_instigator", objNull, [objNull]] ]; private _old = damage _unit; if (toLower (_projectile) find "bomb" != -1 || toLower (_projectile) find "helicopterexplo" != -1) exitWith { player allowDamage false; [] spawn { sleep 5; player allowDamage true; }; _old; }; if (playerSide isEqualTo independent && {isBurning player} && {_projectile isEqualTo ""}) exitWith {_old;}; if (!isNull _instigator && {!isNull _unit} && {side group _instigator isEqualTo west} && {!(_instigator isEqualTo _unit)} && {((currentWeapon _instigator) call BIS_fnc_baseWeapon) in ["hgun_P07_F", "hgun_P07_khk_F", "arifle_SDAR_F", "SMG_05_F"]} && {_projectile in ["B_556x45_dual", "B_9x21_Ball", "30Rnd_9x21_Mag_SMG_02"]} ) exitWith { private _curWeapon = currentWeapon _instigator; private _distance = [35, 100] select (_curWeapon isEqualTo "arifle_SDAR_F"); _distance = [_distance, 250] select (_curWeapon isEqualTo "SMG_05_F"); if (alive player && {(player distance _instigator) < _distance} && {!(player getVariable["zero_var_restrained", false])}) then { [player,_source] spawn zero_fnc_tazed; }; [] call zero_fnc_hudUpdate;
_old; }; if (_projectile == "G_40mm_HE" ) exitWith { [] call zero_fnc_hudUpdate; _old; }; if (!isNull _source && {!isNull _unit} && {isNull objectParent _unit}) then { if (_source isKindOf "Air" || _source isKindOf "Car" || _source isKindOf "Boat") then { if ((currentWeapon _source) in ["HMG_M2","HMG_127","GMG_20mm","GMG_40mm","LMG_Minigun_Transport","LMG_Minigun_Transport2"]) exitWith {}; if(_old <= 0.95)then { _damage = 0.95; } else { _damage = _old; }; player playMove "amovppnemstpsraswrfldnon"; if((time - zero_var_msgCooldown) > 5) then{ [format["Du wurdest von %1 angefahren",(driver _source) getVariable["zero_var_realname", name (driver _source)]],1] call zero_fnc_msg; zero_var_msgCooldown = time; }; } else { private _vehicle = vehicle _source; if ((driver _vehicle) == _source && {_vehicle isKindOf "Air" || _vehicle isKindOf "Car" || _vehicle isKindOf "Boat"}) then { if(_old <= 0.95)then { _damage = 0.95; } else { _damage = _old; }; player playMove "amovppnemstpsraswrfldnon"; if((time - zero_var_msgCooldown) > 5) then{ [format["Du wurdest von %1 angefahren",(driver _source) getVariable["zero_var_realname", name (driver _source)]],1] call zero_fnc_msg; zero_var_msgCooldown = time; }; }; }; }; if (vest _unit == "V_TacVest_oli" && {!isNull _source} && {_projectile != ""}) then { _damage = _old + (_damage * 0.5); }; if (typeOf (vehicle player) in ["O_Plane_CAS_02_F","I_Plane_Fighter_03_AA_F","B_Plane_CAS_01_F"]) then { _damage = _old + (_damage * 0.5); }; [] call zero_fnc_hudUpdate; _damage;
